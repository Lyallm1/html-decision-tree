!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.decisiontree=e():t.decisiontree=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./ts/index.ts")}({"./ts/index.ts":
/*!*********************!*\
  !*** ./ts/index.ts ***!
  \*********************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tree=void 0;var r=n(/*! ./tree */"./ts/tree.ts");e.Tree=r.Tree},"./ts/tree.ts":
/*!********************!*\
  !*** ./ts/tree.ts ***!
  \********************/
/*! no static exports found */function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.Card=e.Summary=e.Leaf=e.Nary=e.Binary=e.Node=e.DepthFirst=e.Tree=void 0;var s=n(/*! ./util */"./ts/util.ts"),u=function(){function t(){this.jsonStr="",this.root=null,this.history=[],this.summaryElement=new m}return t.prototype.loadJson=function(t){var e=this;return new Promise((function(n,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&(200===i.status?this._loadJson(i.responseText,n,r):r(i.statusText))}.bind(e),i.onerror=function(){r(i.statusText)}.bind(e),i.open("GET",t,!0),i.send()}))},t.prototype._loadJson=function(t,e,n){try{this.jsonStr=t,this.fromJson(),e("JSON loaded")}catch(t){n("JSON Parser Error!")}},t.prototype.fromJson=function(){var t=this;this.root=c.fromJson(JSON.parse(this.jsonStr)),new l(this,(function(t){return t})).result.forEach((function(e){return e.tree=t})),this.summaryElement.parent=this.root,this.summaryElement.tree=this},t.prototype.toHTML=function(t){void 0===t&&(t=null),this.rootElement=t,new l(this,(function(t){return t})).result.forEach((function(e){t.appendChild(e.toHtml()),e.hide()})),t.appendChild(this.summaryElement.toHtml()),this.summaryElement.hide(),this.root.show()},t.prototype.summary=function(t){t.hide(),this.summaryElement.parent=t,this.summaryElement.show()},t}();e.Tree=u;var l=function(){function t(t,e){this.func=e,this.result=[],this.visit(t.root)}return t.prototype.visit=function(t){var e=this;this.result.push(this.func(t)),t.children.forEach((function(t){return e.visit(t)}))},t}();e.DepthFirst=l;var h=0,d=0,c=function(){function t(t,e,n,r){var i,a;void 0===e&&(e=""),void 0===n&&(n=0),void 0===r&&(r=[]),this.content=t,this.title=e,this.value=n,this.kind="",this.labels=new Map,this.children=new Map,this.parent=null,this.variable="dt_variable_"+h++,this.radioButtons=[],this.nextName="Next",this.previousName="Back",this.card=new v;try{for(var s=o(r),u=s.next();!u.done;u=s.next()){var l=u.value,d=l.text,c=l.value;this.labels.set(c,d)}}catch(t){i={error:t}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}}return t.parseChildren=function(e,n){var r,i;if(n&&n.length)try{for(var a=o(n),s=a.next();!s.done;s=a.next()){var u=s.value,l=t.fromJson(u);e.children.set(l.value,l),l.parent=e}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},t.fromJson=function(e){var n=null;switch(e.type||"leaf"){case"leaf":n=new y(e.content,e.title,e.value,e.action);break;case"nary":n=new p(e.content,e.title,e.value,e.labels||[]),t.parseChildren(n,e.children);break;case"binary":n=new f(e.content,e.title,e.value),t.parseChildren(n,e.children);break;default:throw Error("Unknown node type.")}return n},t.prototype.toHtml=function(){s.default.addClass(this.card.div,this.kind),this.card.title.innerHTML=this.title;var t=document.createElement("span");return s.default.addClass(t,"CONTENT"),t.innerHTML=this.content,this.card.content.appendChild(t),this.radios(),this.buttons(),this.card.div},t.prototype.radios=function(){var t,e;try{for(var n=o(this.labels),r=n.next();!r.done;r=n.next()){var i=a(r.value,2),u=i[0],l=i[1],h=s.default.makeDiv("RADIOBUTTON"),c=document.createElement("input");s.default.addClass(c,"RADIO");var f="dt_id_"+d++,p="dt_id_"+d++;c.type="radio",c.id=f,c.name=this.variable,c.value=u.toString(),c.setAttribute("aria-labelledby",p),this.radioButtons.push(c);var y=document.createElement("label");s.default.addClass(y,"LABEL"),y.id=p,y.setAttribute("for",f),y.innerHTML=l,h.appendChild(c),h.appendChild(y),this.card.content.appendChild(h)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.buttons=function(){this.parent&&s.default.makeButton(this.previousName,this.firePrevious.bind(this),this.card.buttons,"PREVIOUS"),s.default.makeButton(this.nextName,this.fireNext.bind(this),this.card.buttons,"NEXT")},t.prototype.fireNext=function(){var t,e;try{for(var n=o(this.radioButtons),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.checked){var a=i.value,s=parseInt(a,10);return this.tree.history.push(s),this.hide(),void this.children.get(s).show()}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.firePrevious=function(){this.parent&&(this.hide(),this.parent.show())},t.prototype.show=function(){this.card.show()},t.prototype.hide=function(){this.card.hide()},t}();e.Node=c;var f=function(t){function e(e,n,r){void 0===r&&(r=0);var i=t.call(this,e,n,r,[{text:"Yes",value:1},{text:"No",value:0}])||this;return i.content=e,i.title=n,i.value=r,i.kind="binary",i}return i(e,t),e}(c);e.Binary=f;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.kind="nary",e}return i(e,t),e}(c);e.Nary=p;var y=function(t){function e(e,n,r,i){void 0===i&&(i="");var o=t.call(this,e,n,r)||this;return o.action=i,o.kind="leaf",o.nextName="Restart",o}return i(e,t),e.prototype.buttons=function(){t.prototype.buttons.call(this),this.summaryButton=s.default.makeButton("Summary",this.fireSummary.bind(this),this.card.buttons),this.action&&(this.actionButton=s.default.makeButton("Go",this.fireAction.bind(this),this.card.buttons,"ACTION"),document.createElement("button"))},e.prototype.fireAction=function(){window.open(this.action,"_blank")},e.prototype.fireSummary=function(){this.tree.summary(this)},e.prototype.fireNext=function(){this.hide(),this.tree.root.show(),this.tree.history=[]},e}(c);e.Leaf=y;var m=function(t){function e(){var e=t.call(this,"","Summary")||this;return e.kind="summary",e.nextName="Restart",e.summaryElement=s.default.makeDiv("SUMMARY"),e.card.content.appendChild(e.summaryElement),e}return i(e,t),e.prototype.fireNext=function(){this.hide(),this.tree.root.show(),this.tree.history=[]},e.prototype.show=function(){t.prototype.show.call(this),this.compileSummary()},e.prototype.compileSummary=function(){var t=this,e=0,n=this.tree.history.length;console.log(n);var r=this.parent,i=[];this.summaryElement.innerHTML="";do{var o=e?r.labels.get(this.tree.history[n-e]):"";i.unshift(this.makeSummaryLine(r.content,o)),r=r.parent,e++}while(r);console.log(i),i.forEach((function(e){return t.summaryElement.appendChild(e)}))},e.prototype.makeSummaryLine=function(t,e){var n=s.default.makeDiv("SUMMARYLINE");return s.default.makeSpan(n,t,"QUESTION"),s.default.makeSpan(n,e,"ANSWER"),n},e}(c);e.Summary=m;var v=function(){function t(){this.div=s.default.makeDiv("NODE"),this.title=s.default.makeDiv("TITLE"),this.content=s.default.makeDiv("CONTENT"),this.buttons=s.default.makeDiv("BUTTONS"),this.div.appendChild(this.title),this.title.setAttribute("tabindex","-1"),this.div.appendChild(this.content),this.content.setAttribute("tabindex","-1"),this.div.appendChild(this.buttons)}return t.prototype.show=function(){this.div.style.display="block",this.content.setAttribute("tabindex","0"),this.title.setAttribute("aria-live","polite"),this.title.setAttribute("tabindex","0")},t.prototype.hide=function(){this.div.style.display="none",this.content.setAttribute("tabindex","-1"),this.title.removeAttribute("aria-live"),this.title.setAttribute("tabindex","-1")},t}();e.Card=v},"./ts/util.ts":
/*!********************!*\
  !*** ./ts/util.ts ***!
  \********************/
/*! no static exports found */function(t,e,n){"use strict";var r,i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.makeButton=function(e,n,r,i){void 0===i&&(i="");var o=document.createElement("button");return o.innerHTML=e,t.addClass(o,i||e.toUpperCase(),"BUTTON"),o.addEventListener("click",n),r.appendChild(o),o};t.addClass=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];e.forEach((function(e){return t.classList.add("DT_"+e.toUpperCase())}))},t.makeDiv=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=document.createElement("div");return t.addClass.apply(void 0,o([r],e)),r},t.makeSpan=function(e,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var a=document.createElement("span");t.addClass.apply(void 0,o([a],r)),a.innerHTML=n,e.appendChild(a)}}(r||(r={})),e.default=r}})}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZWNpc2lvbnRyZWUvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL2RlY2lzaW9udHJlZS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9kZWNpc2lvbnRyZWUvLi90cy9pbmRleC50cyIsIndlYnBhY2s6Ly9kZWNpc2lvbnRyZWUvLi90cy90cmVlLnRzIiwid2VicGFjazovL2RlY2lzaW9udHJlZS8uL3RzL3V0aWwudHMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwidGhpcyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJUcmVlIiwianNvblN0ciIsImhpc3RvcnkiLCJzdW1tYXJ5RWxlbWVudCIsIlN1bW1hcnkiLCJsb2FkSnNvbiIsInVybCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiaHR0cFJlcXVlc3QiLCJYTUxIdHRwUmVxdWVzdCIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJfbG9hZEpzb24iLCJyZXNwb25zZVRleHQiLCJzdGF0dXNUZXh0Iiwib25lcnJvciIsIm9wZW4iLCJzZW5kIiwianNvbiIsImZyb21Kc29uIiwiZXJyIiwiTm9kZSIsIkpTT04iLCJwYXJzZSIsIkRlcHRoRmlyc3QiLCJ4IiwicmVzdWx0IiwiZm9yRWFjaCIsInRyZWUiLCJwYXJlbnQiLCJ0b0hUTUwiLCJub2RlIiwicm9vdEVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsInRvSHRtbCIsImhpZGUiLCJzaG93Iiwic3VtbWFyeSIsImZ1bmMiLCJ2aXNpdCIsInB1c2giLCJjaGlsZHJlbiIsImNvdW50ZXIiLCJsYWJlbENvdW50ZXIiLCJjb250ZW50IiwidGl0bGUiLCJsYWJlbHMiLCJraW5kIiwiTWFwIiwidmFyaWFibGUiLCJyYWRpb0J1dHRvbnMiLCJuZXh0TmFtZSIsInByZXZpb3VzTmFtZSIsImNhcmQiLCJDYXJkIiwidGV4dCIsInNldCIsInBhcnNlQ2hpbGRyZW4iLCJsZW5ndGgiLCJjaGlsZCIsImNoaWxkTm9kZSIsInR5cGUiLCJMZWFmIiwiYWN0aW9uIiwiTmFyeSIsIkJpbmFyeSIsIkVycm9yIiwiYWRkQ2xhc3MiLCJkaXYiLCJpbm5lckhUTUwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJyYWRpb3MiLCJidXR0b25zIiwibWFrZURpdiIsInJhZGlvIiwicmFkaW9JZCIsImxhYmVsSWQiLCJpZCIsInRvU3RyaW5nIiwic2V0QXR0cmlidXRlIiwibGFiZWwiLCJtYWtlQnV0dG9uIiwiZmlyZVByZXZpb3VzIiwiZmlyZU5leHQiLCJjaGVja2VkIiwibnVtIiwicGFyc2VJbnQiLCJzdW1tYXJ5QnV0dG9uIiwiZmlyZVN1bW1hcnkiLCJhY3Rpb25CdXR0b24iLCJmaXJlQWN0aW9uIiwid2luZG93IiwiY29tcGlsZVN1bW1hcnkiLCJjb3VudCIsImhsIiwiY29uc29sZSIsImxvZyIsImFuc3dlciIsInVuc2hpZnQiLCJtYWtlU3VtbWFyeUxpbmUiLCJxdWVzdGlvbiIsIm1ha2VTcGFuIiwic3R5bGUiLCJkaXNwbGF5IiwicmVtb3ZlQXR0cmlidXRlIiwiVXRpbCIsImNsYXNzbmFtZSIsImJ1dHRvbiIsInRvVXBwZXJDYXNlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImVsZW1lbnQiLCJyZXN0IiwiY2xh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QVcsU0FDdEJ6RSxFQUFxQmUsRyxJQUFpQix3REFDdEMsSUFBSXVFLEVBQU83QyxTQUFTQyxjQUFjLFFBQ2xDLEVBQUFKLFNBQVEsZ0JBQUNnRCxHQUFTUixJQUNsQlEsRUFBSzlDLFVBQVl6QixFQUNqQmYsRUFBT0ksWUFBWWtGLElBOUJ2QixDQUFVVCxNQUFJLEtBbUNkLFVBQWVBIiwiZmlsZSI6ImRlY2lzaW9udHJlZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcImRlY2lzaW9udHJlZVwiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJkZWNpc2lvbnRyZWVcIl0gPSBmYWN0b3J5KCk7XG59KSh0aGlzLCBmdW5jdGlvbigpIHtcbnJldHVybiAiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gXCIuL3RzL2luZGV4LnRzXCIpO1xuIiwiaW1wb3J0IHtUcmVlIGFzIG9iajB9IGZyb20gJy4vdHJlZSc7XG5cbmV4cG9ydCBsZXQgVHJlZSA9IG9iajA7XG4iLCIvLyBJbml0aWFsIHRyZWVcbmltcG9ydCBVdGlsIGZyb20gJy4vdXRpbCc7XG5cblxuZXhwb3J0IGNsYXNzIFRyZWUge1xuXG4gIHB1YmxpYyBqc29uU3RyOiBzdHJpbmcgPSAnJztcbiAgcHVibGljIHJvb3Q6IE5vZGUgPSBudWxsO1xuICBwdWJsaWMgaGlzdG9yeTogbnVtYmVyW10gPSBbXTtcbiAgcHVibGljIHJvb3RFbGVtZW50OiBIVE1MRWxlbWVudDtcbiAgcHVibGljIHN1bW1hcnlFbGVtZW50OiBTdW1tYXJ5ID0gbmV3IFN1bW1hcnkoKTtcblxuICBwdWJsaWMgbG9hZEpzb24odXJsOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgbGV0IGh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICBodHRwUmVxdWVzdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGh0dHBSZXF1ZXN0LnJlYWR5U3RhdGUgPT09IDQpIHtcbiAgICAgICAgICBpZiAoaHR0cFJlcXVlc3Quc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgIHRoaXMuX2xvYWRKc29uKGh0dHBSZXF1ZXN0LnJlc3BvbnNlVGV4dCwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KGh0dHBSZXF1ZXN0LnN0YXR1c1RleHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfS5iaW5kKHRoaXMpO1xuICAgICAgaHR0cFJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QoaHR0cFJlcXVlc3Quc3RhdHVzVGV4dCk7XG4gICAgICB9LmJpbmQodGhpcyk7XG4gICAgICBodHRwUmVxdWVzdC5vcGVuKCdHRVQnLCB1cmwsIHRydWUpO1xuICAgICAgaHR0cFJlcXVlc3Quc2VuZCgpO1xuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIF9sb2FkSnNvbihqc29uOiBzdHJpbmcsIHJlc29sdmU6IEZ1bmN0aW9uLCByZWplY3Q6IEZ1bmN0aW9uKSB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuanNvblN0ciA9IGpzb247XG4gICAgICB0aGlzLmZyb21Kc29uKCk7XG4gICAgICByZXNvbHZlKCdKU09OIGxvYWRlZCcpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmVqZWN0KCdKU09OIFBhcnNlciBFcnJvciEnKTtcbiAgICB9XG4gIH1cblxuXG4gIHB1YmxpYyBmcm9tSnNvbigpIHtcbiAgICB0aGlzLnJvb3QgPSBOb2RlLmZyb21Kc29uKEpTT04ucGFyc2UodGhpcy5qc29uU3RyKSk7XG4gICAgbGV0IGRmcyA9IG5ldyBEZXB0aEZpcnN0KHRoaXMsICh4OiBOb2RlKSA9PiB4KTtcbiAgICBkZnMucmVzdWx0LmZvckVhY2gobiA9PiBuLnRyZWUgPSB0aGlzKTtcbiAgICB0aGlzLnN1bW1hcnlFbGVtZW50LnBhcmVudCA9IHRoaXMucm9vdDtcbiAgICB0aGlzLnN1bW1hcnlFbGVtZW50LnRyZWUgPSB0aGlzO1xuICB9XG5cblxuICBwdWJsaWMgdG9IVE1MKG5vZGU6IEhUTUxFbGVtZW50ID0gbnVsbCkge1xuICAgIHRoaXMucm9vdEVsZW1lbnQgPSBub2RlO1xuICAgIGxldCBkZnMgPSBuZXcgRGVwdGhGaXJzdCh0aGlzLCAoeDogTm9kZSkgPT4geCk7XG4gICAgZGZzLnJlc3VsdC5mb3JFYWNoKChuOiBOb2RlKSA9PiB7XG4gICAgICBub2RlLmFwcGVuZENoaWxkKG4udG9IdG1sKCkpO1xuICAgICAgbi5oaWRlKCk7XG4gICAgfSk7XG4gICAgbm9kZS5hcHBlbmRDaGlsZCh0aGlzLnN1bW1hcnlFbGVtZW50LnRvSHRtbCgpKTtcbiAgICB0aGlzLnN1bW1hcnlFbGVtZW50LmhpZGUoKTtcbiAgICB0aGlzLnJvb3Quc2hvdygpO1xuICB9XG5cbiAgcHVibGljIHN1bW1hcnkobm9kZTogTm9kZSkge1xuICAgIG5vZGUuaGlkZSgpO1xuICAgIHRoaXMuc3VtbWFyeUVsZW1lbnQucGFyZW50ID0gbm9kZTtcbiAgICB0aGlzLnN1bW1hcnlFbGVtZW50LnNob3coKTtcbiAgfVxuXG59XG5cblxuZXhwb3J0IGNsYXNzIERlcHRoRmlyc3Qge1xuXG4gIHB1YmxpYyByZXN1bHQ6IGFueVtdID0gW107XG5cbiAgY29uc3RydWN0b3IodHJlZTogVHJlZSwgcHJpdmF0ZSBmdW5jOiBGdW5jdGlvbikge1xuICAgIHRoaXMudmlzaXQodHJlZS5yb290KTtcbiAgfVxuXG4gIHByaXZhdGUgdmlzaXQobm9kZTogTm9kZSkge1xuICAgIHRoaXMucmVzdWx0LnB1c2godGhpcy5mdW5jKG5vZGUpKTtcbiAgICBub2RlLmNoaWxkcmVuLmZvckVhY2goeCA9PiB0aGlzLnZpc2l0KHgpKTtcbiAgfVxuXG59XG5cblxubGV0IGNvdW50ZXIgPSAwO1xubGV0IGxhYmVsQ291bnRlciA9IDA7XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBOb2RlIHtcblxuICBwdWJsaWMga2luZDogc3RyaW5nID0gJyc7XG4gIHB1YmxpYyB0cmVlOiBUcmVlO1xuICBwdWJsaWMgbGFiZWxzOiBNYXA8bnVtYmVyLCBzdHJpbmc+ID0gbmV3IE1hcDxudW1iZXIsIHN0cmluZz4oKTtcbiAgcHVibGljIGNoaWxkcmVuOiBNYXA8bnVtYmVyLCBOb2RlPiA9IG5ldyBNYXA8bnVtYmVyLCBOb2RlPigpO1xuICBwdWJsaWMgcGFyZW50OiBOb2RlID0gbnVsbDtcbiAgcHVibGljIHZhcmlhYmxlOiBzdHJpbmcgPSAnZHRfdmFyaWFibGVfJyArIGNvdW50ZXIrKztcbiAgcHVibGljIGNhcmQ6IENhcmQ7XG4gIHB1YmxpYyByYWRpb0J1dHRvbnM6IEhUTUxFbGVtZW50W10gPSBbXTtcblxuICBwdWJsaWMgbmV4dE5hbWU6IHN0cmluZyA9ICdOZXh0JztcbiAgcHVibGljIHByZXZpb3VzTmFtZTogc3RyaW5nID0gJ0JhY2snO1xuXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBjb250ZW50OiBzdHJpbmcsIHB1YmxpYyB0aXRsZTogc3RyaW5nID0gJycsXG4gICAgICAgICAgICAgIHB1YmxpYyB2YWx1ZSA9IDAsXG4gICAgICAgICAgICAgIGxhYmVsczoge3RleHQ6IHN0cmluZywgdmFsdWU6IG51bWJlcn1bXSA9IFtdKSB7XG4gICAgdGhpcy5jYXJkID0gbmV3IENhcmQoKTtcbiAgICBmb3IgKGxldCB7dGV4dDogdGV4dCwgdmFsdWU6IHZhbHVlfSBvZiBsYWJlbHMpIHtcbiAgICAgIHRoaXMubGFiZWxzLnNldCh2YWx1ZSwgdGV4dCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgcGFyc2VDaGlsZHJlbihub2RlOiBOb2RlLCBqc29uOiBhbnlbXSkge1xuICAgIGlmICghanNvbiB8fCAhanNvbi5sZW5ndGgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZm9yIChjb25zdCBjaGlsZCBvZiBqc29uKSB7XG4gICAgICBsZXQgY2hpbGROb2RlID0gTm9kZS5mcm9tSnNvbihjaGlsZCk7XG4gICAgICBub2RlLmNoaWxkcmVuLnNldChjaGlsZE5vZGUudmFsdWUsIGNoaWxkTm9kZSk7XG4gICAgICBjaGlsZE5vZGUucGFyZW50ID0gbm9kZTtcbiAgICB9XG4gIH1cblxuICBzdGF0aWMgZnJvbUpzb24oanNvbjogYW55KTogTm9kZSB7XG4gICAgbGV0IGtpbmQgPSBqc29uLnR5cGUgfHwgJ2xlYWYnO1xuICAgIGxldCBub2RlOiBOb2RlID0gbnVsbDtcbiAgICBzd2l0Y2ggKGtpbmQpIHtcbiAgICAgIGNhc2UgJ2xlYWYnOlxuICAgICAgICBub2RlID0gbmV3IExlYWYoanNvbi5jb250ZW50LCBqc29uLnRpdGxlLCBqc29uLnZhbHVlLCBqc29uLmFjdGlvbik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnbmFyeSc6XG4gICAgICAgIG5vZGUgPSBuZXcgTmFyeShqc29uLmNvbnRlbnQsIGpzb24udGl0bGUsIGpzb24udmFsdWUsIGpzb24ubGFiZWxzIHx8IFtdKTtcbiAgICAgICAgTm9kZS5wYXJzZUNoaWxkcmVuKG5vZGUsIGpzb24uY2hpbGRyZW4pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgIG5vZGUgPSBuZXcgQmluYXJ5KGpzb24uY29udGVudCwganNvbi50aXRsZSwganNvbi52YWx1ZSk7XG4gICAgICAgIE5vZGUucGFyc2VDaGlsZHJlbihub2RlLCBqc29uLmNoaWxkcmVuKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBFcnJvcignVW5rbm93biBub2RlIHR5cGUuJyk7XG4gICAgfVxuICAgIHJldHVybiBub2RlO1xuICB9XG5cbiAgcHVibGljIHRvSHRtbCgpOiBIVE1MRWxlbWVudCB7XG4gICAgVXRpbC5hZGRDbGFzcyh0aGlzLmNhcmQuZGl2LCB0aGlzLmtpbmQpO1xuICAgIC8vIEFjdHVhbCB0aXRsZSBlbGVtZW50XG4gICAgdGhpcy5jYXJkLnRpdGxlLmlubmVySFRNTCA9IHRoaXMudGl0bGU7XG4gICAgLy8gQWN0dWFsIGNvbnRlbnQgZWxlbWVudFxuICAgIGxldCBjb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIFV0aWwuYWRkQ2xhc3MoY29udGVudCwgJ0NPTlRFTlQnKTtcbiAgICBjb250ZW50LmlubmVySFRNTCA9IHRoaXMuY29udGVudDtcbiAgICB0aGlzLmNhcmQuY29udGVudC5hcHBlbmRDaGlsZChjb250ZW50KTtcbiAgICB0aGlzLnJhZGlvcygpO1xuICAgIHRoaXMuYnV0dG9ucygpO1xuICAgIHJldHVybiB0aGlzLmNhcmQuZGl2O1xuICB9XG5cblxuICBwcm90ZWN0ZWQgcmFkaW9zKCkge1xuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIHRoaXMubGFiZWxzKSB7XG4gICAgICBsZXQgY29udGVudCA9IFV0aWwubWFrZURpdignUkFESU9CVVRUT04nKTtcbiAgICAgIGxldCByYWRpbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgICBVdGlsLmFkZENsYXNzKHJhZGlvLCAnUkFESU8nKTtcbiAgICAgIGxldCByYWRpb0lkID0gJ2R0X2lkXycgKyBsYWJlbENvdW50ZXIrKztcbiAgICAgIGxldCBsYWJlbElkID0gJ2R0X2lkXycgKyBsYWJlbENvdW50ZXIrKztcbiAgICAgIHJhZGlvLnR5cGUgPSAncmFkaW8nO1xuICAgICAgcmFkaW8uaWQgPSByYWRpb0lkO1xuICAgICAgcmFkaW8ubmFtZSA9IHRoaXMudmFyaWFibGU7XG4gICAgICByYWRpby52YWx1ZSA9IGtleS50b1N0cmluZygpO1xuICAgICAgcmFkaW8uc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsbGVkYnknLCBsYWJlbElkKTtcbiAgICAgIHRoaXMucmFkaW9CdXR0b25zLnB1c2gocmFkaW8pO1xuICAgICAgbGV0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcbiAgICAgIFV0aWwuYWRkQ2xhc3MobGFiZWwsICdMQUJFTCcpO1xuICAgICAgbGFiZWwuaWQgPSBsYWJlbElkO1xuICAgICAgbGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCByYWRpb0lkKTtcbiAgICAgIGxhYmVsLmlubmVySFRNTCA9IHZhbHVlO1xuICAgICAgY29udGVudC5hcHBlbmRDaGlsZChyYWRpbyk7XG4gICAgICBjb250ZW50LmFwcGVuZENoaWxkKGxhYmVsKTtcbiAgICAgIHRoaXMuY2FyZC5jb250ZW50LmFwcGVuZENoaWxkKGNvbnRlbnQpO1xuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCBidXR0b25zKCkge1xuICAgIGlmICh0aGlzLnBhcmVudCkge1xuICAgICAgVXRpbC5tYWtlQnV0dG9uKFxuICAgICAgICB0aGlzLnByZXZpb3VzTmFtZSwgdGhpcy5maXJlUHJldmlvdXMuYmluZCh0aGlzKSwgdGhpcy5jYXJkLmJ1dHRvbnMsICdQUkVWSU9VUycpO1xuICAgIH1cbiAgICBVdGlsLm1ha2VCdXR0b24odGhpcy5uZXh0TmFtZSwgdGhpcy5maXJlTmV4dC5iaW5kKHRoaXMpLCB0aGlzLmNhcmQuYnV0dG9ucywgJ05FWFQnKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBmaXJlTmV4dCgpIHtcbiAgICBmb3IgKGxldCByYWRpbyBvZiB0aGlzLnJhZGlvQnV0dG9ucykge1xuICAgICAgaWYgKChyYWRpbyBhcyBhbnkpLmNoZWNrZWQpIHtcbiAgICAgICAgbGV0IHZhbHVlID0gKHJhZGlvIGFzIGFueSkudmFsdWU7XG4gICAgICAgIGxldCBudW0gPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgICAgICB0aGlzLnRyZWUuaGlzdG9yeS5wdXNoKG51bSk7XG4gICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICB0aGlzLmNoaWxkcmVuLmdldChudW0pLnNob3coKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCBmaXJlUHJldmlvdXMoKSB7XG4gICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICB0aGlzLmhpZGUoKTtcbiAgICAgIHRoaXMucGFyZW50LnNob3coKTtcbiAgICB9XG4gIH1cblxuXG4gIC8vIFRPRE86IFRoaXMgaXMgcHJvYmFibHkgb3ZlcmtpbGwuXG4gIHB1YmxpYyBzaG93KCkge1xuICAgIHRoaXMuY2FyZC5zaG93KCk7XG4gIH1cblxuICBwdWJsaWMgaGlkZSgpIHtcbiAgICB0aGlzLmNhcmQuaGlkZSgpO1xuICB9XG5cbn1cblxuZXhwb3J0IGNsYXNzIEJpbmFyeSBleHRlbmRzIE5vZGUge1xuXG4gIC8qKlxuICAgKiBAb3ZlcnJpZGVcbiAgICovXG4gIHB1YmxpYyBraW5kID0gJ2JpbmFyeSc7XG5cbiAgY29uc3RydWN0b3IocHVibGljIGNvbnRlbnQ6IHN0cmluZywgcHVibGljIHRpdGxlOiBzdHJpbmcsIHB1YmxpYyB2YWx1ZSA9IDApIHtcbiAgICBzdXBlcihjb250ZW50LCB0aXRsZSwgdmFsdWUsXG4gICAgICAgICAgW3t0ZXh0OiAnWWVzJywgdmFsdWU6IDF9LCB7dGV4dDogJ05vJywgdmFsdWU6IDB9XSk7XG4gIH1cblxufVxuXG5cbmV4cG9ydCBjbGFzcyBOYXJ5IGV4dGVuZHMgTm9kZSB7XG4gIHB1YmxpYyBraW5kID0gJ25hcnknXG5cbn1cblxuXG5leHBvcnQgY2xhc3MgTGVhZiBleHRlbmRzIE5vZGUge1xuICBwdWJsaWMga2luZCA9ICdsZWFmJztcbiAgcHVibGljIG5leHROYW1lID0gJ1Jlc3RhcnQnO1xuICBwdWJsaWMgc3VtbWFyeUJ1dHRvbjogSFRNTEVsZW1lbnQ7XG4gIHB1YmxpYyBhY3Rpb25CdXR0b246IEhUTUxFbGVtZW50O1xuXG4gIGNvbnN0cnVjdG9yKGNvbnRlbnQ6IHN0cmluZywgdGl0bGU6IHN0cmluZywgdmFsdWU6IG51bWJlcixcbiAgICAgICAgICAgICAgcHVibGljIGFjdGlvbjogc3RyaW5nID0gJycpIHtcbiAgICBzdXBlcihjb250ZW50LCB0aXRsZSwgdmFsdWUpO1xuICB9XG5cblxuICBwcm90ZWN0ZWQgYnV0dG9ucygpIHtcbiAgICBzdXBlci5idXR0b25zKCk7XG4gICAgdGhpcy5zdW1tYXJ5QnV0dG9uID0gVXRpbC5tYWtlQnV0dG9uKFxuICAgICAgJ1N1bW1hcnknLCB0aGlzLmZpcmVTdW1tYXJ5LmJpbmQodGhpcyksIHRoaXMuY2FyZC5idXR0b25zKTtcbiAgICBpZiAodGhpcy5hY3Rpb24pIHtcbiAgICAgIHRoaXMuYWN0aW9uQnV0dG9uID0gVXRpbC5tYWtlQnV0dG9uKFxuICAgICAgICAnR28nLCB0aGlzLmZpcmVBY3Rpb24uYmluZCh0aGlzKSwgdGhpcy5jYXJkLmJ1dHRvbnMsICdBQ1RJT04nKTtcbiAgICAgIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCBmaXJlQWN0aW9uKCkge1xuICAgIHdpbmRvdy5vcGVuKHRoaXMuYWN0aW9uLCAnX2JsYW5rJyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZmlyZVN1bW1hcnkoKSB7XG4gICAgdGhpcy50cmVlLnN1bW1hcnkodGhpcyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZmlyZU5leHQoKSB7XG4gICAgdGhpcy5oaWRlKCk7XG4gICAgdGhpcy50cmVlLnJvb3Quc2hvdygpO1xuICAgIHRoaXMudHJlZS5oaXN0b3J5ID0gW107XG4gIH1cblxufVxuXG5cbmV4cG9ydCBjbGFzcyBTdW1tYXJ5IGV4dGVuZHMgTm9kZSB7XG5cbiAgcHVibGljIGtpbmQgPSAnc3VtbWFyeSc7XG4gIHB1YmxpYyBuZXh0TmFtZSA9ICdSZXN0YXJ0JztcbiAgcHVibGljIHN1bW1hcnlFbGVtZW50ID0gVXRpbC5tYWtlRGl2KCdTVU1NQVJZJyk7XG4gIFxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcignJywgJ1N1bW1hcnknKTtcbiAgICB0aGlzLmNhcmQuY29udGVudC5hcHBlbmRDaGlsZCh0aGlzLnN1bW1hcnlFbGVtZW50KTtcbiAgfVxuXG4gIHByb3RlY3RlZCBmaXJlTmV4dCgpIHtcbiAgICB0aGlzLmhpZGUoKTtcbiAgICB0aGlzLnRyZWUucm9vdC5zaG93KCk7XG4gICAgdGhpcy50cmVlLmhpc3RvcnkgPSBbXTtcbiAgfVxuXG4gIHB1YmxpYyBzaG93KCkge1xuICAgIHN1cGVyLnNob3coKTtcbiAgICB0aGlzLmNvbXBpbGVTdW1tYXJ5KCk7XG4gIH1cblxuICBwcml2YXRlIGNvbXBpbGVTdW1tYXJ5KCkge1xuICAgIGxldCBjb3VudCA9IDA7XG4gICAgbGV0IGhsID0gdGhpcy50cmVlLmhpc3RvcnkubGVuZ3RoO1xuICAgIGNvbnNvbGUubG9nKGhsKTtcbiAgICBsZXQgbm9kZSA9IHRoaXMucGFyZW50O1xuICAgIGxldCByZXN1bHQgPSBbXTtcbiAgICB0aGlzLnN1bW1hcnlFbGVtZW50LmlubmVySFRNTCA9ICcnO1xuICAgIGRvIHtcbiAgICAgIGxldCBhbnN3ZXIgPSBjb3VudCA/IG5vZGUubGFiZWxzLmdldCh0aGlzLnRyZWUuaGlzdG9yeVtobCAtIGNvdW50XSkgOiAnJztcbiAgICAgIHJlc3VsdC51bnNoaWZ0KHRoaXMubWFrZVN1bW1hcnlMaW5lKG5vZGUuY29udGVudCwgYW5zd2VyKSk7XG4gICAgICBub2RlID0gbm9kZS5wYXJlbnQ7XG4gICAgICBjb3VudCsrO1xuICAgIH0gd2hpbGUgKG5vZGUpO1xuICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gICAgcmVzdWx0LmZvckVhY2goeCA9PiB0aGlzLnN1bW1hcnlFbGVtZW50LmFwcGVuZENoaWxkKHgpKTtcbiAgfVxuXG4gIHByaXZhdGUgbWFrZVN1bW1hcnlMaW5lKHF1ZXN0aW9uOiBzdHJpbmcsIGFuc3dlcjogc3RyaW5nKTogSFRNTEVsZW1lbnQge1xuICAgIGxldCBkaXYgPSBVdGlsLm1ha2VEaXYoJ1NVTU1BUllMSU5FJyk7XG4gICAgVXRpbC5tYWtlU3BhbihkaXYsIHF1ZXN0aW9uLCAnUVVFU1RJT04nKTtcbiAgICBVdGlsLm1ha2VTcGFuKGRpdiwgYW5zd2VyLCAnQU5TV0VSJyk7XG4gICAgcmV0dXJuIGRpdjtcbiAgfVxuXG59XG5cbmV4cG9ydCBjbGFzcyBDYXJkIHtcblxuICBwdWJsaWMgZGl2OiBIVE1MRWxlbWVudCA9IFV0aWwubWFrZURpdignTk9ERScpO1xuICBwdWJsaWMgdGl0bGU6IEhUTUxFbGVtZW50ID0gVXRpbC5tYWtlRGl2KCdUSVRMRScpO1xuICBwdWJsaWMgY29udGVudDogSFRNTEVsZW1lbnQgPSBVdGlsLm1ha2VEaXYoJ0NPTlRFTlQnKVxuICBwdWJsaWMgYnV0dG9uczogSFRNTEVsZW1lbnQgPSBVdGlsLm1ha2VEaXYoJ0JVVFRPTlMnKTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmRpdi5hcHBlbmRDaGlsZCh0aGlzLnRpdGxlKTtcbiAgICB0aGlzLnRpdGxlLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcbiAgICB0aGlzLmRpdi5hcHBlbmRDaGlsZCh0aGlzLmNvbnRlbnQpO1xuICAgIHRoaXMuY29udGVudC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG4gICAgdGhpcy5kaXYuYXBwZW5kQ2hpbGQodGhpcy5idXR0b25zKTtcbiAgfVxuXG4gIHB1YmxpYyBzaG93KCkge1xuICAgIHRoaXMuZGl2LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIHRoaXMuY29udGVudC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJzAnKTtcbiAgICB0aGlzLnRpdGxlLnNldEF0dHJpYnV0ZSgnYXJpYS1saXZlJywgJ3BvbGl0ZScpO1xuICAgIHRoaXMudGl0bGUuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICcwJyk7XG4gIH1cblxuICBwdWJsaWMgaGlkZSgpIHtcbiAgICB0aGlzLmRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIHRoaXMuY29udGVudC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG4gICAgdGhpcy50aXRsZS5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtbGl2ZScpO1xuICAgIHRoaXMudGl0bGUuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xuICB9XG5cbn1cbiIsIm5hbWVzcGFjZSBVdGlsIHtcblxuICBleHBvcnQgY29uc3QgbWFrZUJ1dHRvbiA9IGZ1bmN0aW9uKFxuICAgIG5hbWU6IHN0cmluZywgYWN0aW9uOiAoKSA9PiBhbnksIHBhcmVudDogSFRNTEVsZW1lbnQsXG4gICAgY2xhc3NuYW1lOiBzdHJpbmcgPSAnJyk6IEhUTUxCdXR0b25FbGVtZW50IHtcbiAgICBsZXQgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgYnV0dG9uLmlubmVySFRNTCA9IG5hbWU7XG4gICAgYWRkQ2xhc3MoYnV0dG9uLCBjbGFzc25hbWUgfHwgbmFtZS50b1VwcGVyQ2FzZSgpLCAnQlVUVE9OJyk7XG4gICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYWN0aW9uKTtcbiAgICBwYXJlbnQuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcbiAgICByZXR1cm4gYnV0dG9uO1xuICB9O1xuXG4gIGxldCBwcmVmaXggPSAnRFRfJztcblxuICBleHBvcnQgY29uc3QgYWRkQ2xhc3MgPSBmdW5jdGlvbihlbGVtZW50OiBIVE1MRWxlbWVudCwgLi4ucmVzdDogc3RyaW5nW10pIHtcbiAgICByZXN0LmZvckVhY2goeCA9PiBlbGVtZW50LmNsYXNzTGlzdC5hZGQocHJlZml4ICsgeC50b1VwcGVyQ2FzZSgpKSk7XG4gIH07XG5cbiAgZXhwb3J0IGNvbnN0IG1ha2VEaXYgPSBmdW5jdGlvbiguLi5jbGFzc25hbWU6IHN0cmluZ1tdKSB7XG4gICAgbGV0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGFkZENsYXNzKGRpdiwgLi4uY2xhc3NuYW1lKTtcbiAgICByZXR1cm4gZGl2O1xuICB9O1xuXG4gIGV4cG9ydCBjb25zdCBtYWtlU3BhbiA9IGZ1bmN0aW9uKFxuICAgIHBhcmVudDogSFRNTEVsZW1lbnQsIGNvbnRlbnQ6IHN0cmluZywgLi4uY2xhc3NuYW1lOiBzdHJpbmdbXSkge1xuICAgIGxldCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIGFkZENsYXNzKHNwYW4sIC4uLmNsYXNzbmFtZSk7XG4gICAgc3Bhbi5pbm5lckhUTUwgPSBjb250ZW50O1xuICAgIHBhcmVudC5hcHBlbmRDaGlsZChzcGFuKTtcbiAgfTtcblxufVxuXG5leHBvcnQgZGVmYXVsdCBVdGlsO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==