!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.decisiontree=e():t.decisiontree=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./ts/index.ts")}({"./ts/index.ts":
/*!*********************!*\
  !*** ./ts/index.ts ***!
  \*********************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tree=void 0;var r=n(/*! ./tree */"./ts/tree.ts");e.Tree=r.Tree},"./ts/tree.ts":
/*!********************!*\
  !*** ./ts/tree.ts ***!
  \********************/
/*! no static exports found */function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.Card=e.Summary=e.Leaf=e.Nary=e.Binary=e.Node=e.DepthFirst=e.Tree=void 0;var s=n(/*! ./util */"./ts/util.ts"),u=function(){function t(){this.jsonStr="",this.root=null,this.history=[],this.summaryElement=new p}return t.prototype.loadJson=function(t){var e=this;return new Promise((function(n,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&(200===i.status?this._loadJson(i.responseText,n,r):r(i.statusText))}.bind(e),i.onerror=function(){r(i.statusText)}.bind(e),i.open("GET",t,!0),i.send()}))},t.prototype._loadJson=function(t,e,n){try{this.jsonStr=t,this.fromJson(),e("JSON loaded")}catch(t){n("JSON Parser Error!")}},t.prototype.fromJson=function(){var t=this;this.root=h.fromJson(JSON.parse(this.jsonStr)),new l(this,(function(t){return t})).result.forEach((function(e){return e.tree=t})),this.summaryElement.parent=this.root,this.summaryElement.tree=this},t.prototype.toHTML=function(t){this.rootElement=t,new l(this,(function(t){return t})).result.forEach((function(e){t.appendChild(e.toHtml()),e.hide()})),t.appendChild(this.summaryElement.toHtml()),this.summaryElement.hide(),this.root.show()},t.prototype.summary=function(t){t.hide(),this.summaryElement.parent=t,this.summaryElement.show()},t}();e.Tree=u;var l=function(){function t(t,e){this.func=e,this.result=[],this.visit(t.root)}return t.prototype.visit=function(t){var e=this;this.result.push(this.func(t)),t.children.forEach((function(t){return e.visit(t)}))},t}();e.DepthFirst=l;var h=function(){function t(e,n,r,i){var a,s;void 0===n&&(n=""),void 0===r&&(r=0),void 0===i&&(i=[]),this.content=e,this.title=n,this.value=r,this.kind="",this.labels=new Map,this.children=new Map,this.parent=null,this.variable="dt_variable_"+t.counter++,this.radioButtons=[],this.nextName="Next",this.previousName="Back",this.card=new y;try{for(var u=o(i),l=u.next();!l.done;l=u.next()){var h=l.value,d=h.text,c=h.value;this.labels.set(c,d)}}catch(t){a={error:t}}finally{try{l&&!l.done&&(s=u.return)&&s.call(u)}finally{if(a)throw a.error}}}return t.parseChildren=function(e,n){var r,i;if(n&&n.length)try{for(var a=o(n),s=a.next();!s.done;s=a.next()){var u=s.value,l=t.fromJson(u);e.children.set(l.value,l),l.parent=e}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},t.fromJson=function(e){var n=null;switch(e.type||"leaf"){case"leaf":n=new f(e.content,e.title,e.value,e.action);break;case"nary":n=new c(e.content,e.title,e.value,e.labels||[]),t.parseChildren(n,e.children);break;case"binary":n=new d(e.content,e.title,e.value),t.parseChildren(n,e.children);break;default:throw Error("Unknown node type.")}return n},t.prototype.toHtml=function(){s.default.addClass(this.card.div,this.kind),this.card.title.innerHTML=this.title;var t=document.createElement("span");return s.default.addClass(t,"CONTENT"),t.innerHTML=this.content,this.card.content.appendChild(t),this.radios(),this.buttons(),this.card.div},t.prototype.radios=function(){var e,n;try{for(var r=o(this.labels),i=r.next();!i.done;i=r.next()){var u=a(i.value,2),l=u[0],h=u[1],d=s.default.makeDiv("RADIOBUTTON"),c=document.createElement("input");s.default.addClass(c,"RADIO");var f="dt_id_"+t.labelCounter++,p="dt_id_"+t.labelCounter++;c.type="radio",c.id=f,c.name=this.variable,c.value=l.toString(),this.radioButtons.push(c);var y=document.createElement("label");s.default.addClass(y,"LABEL"),y.id=p,y.setAttribute("for",f),y.innerHTML=h,d.appendChild(c),d.appendChild(y),this.card.content.appendChild(d)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.buttons=function(){this.parent&&s.default.makeButton(this.previousName,this.firePrevious.bind(this),this.card.buttons,"PREVIOUS"),s.default.makeButton(this.nextName,this.fireNext.bind(this),this.card.buttons,"NEXT")},t.prototype.fireNext=function(){var t,e;try{for(var n=o(this.radioButtons),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.checked){var a=i.value,s=parseInt(a,10);return this.tree.history.push(s),this.hide(),void this.children.get(s).show()}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.firePrevious=function(){this.parent&&(this.hide(),this.parent.show())},t.prototype.show=function(){this.card.show()},t.prototype.hide=function(){this.card.hide()},t.counter=0,t.labelCounter=0,t}();e.Node=h;var d=function(t){function e(e,n,r){void 0===r&&(r=0);var i=t.call(this,e,n,r,[{text:"Yes",value:1},{text:"No",value:0}])||this;return i.content=e,i.title=n,i.value=r,i.kind="binary",i}return i(e,t),e}(h);e.Binary=d;var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.kind="nary",e}return i(e,t),e}(h);e.Nary=c;var f=function(t){function e(e,n,r,i){void 0===i&&(i="");var o=t.call(this,e,n,r)||this;return o.action=i,o.kind="leaf",o.nextName="Restart",o}return i(e,t),e.prototype.buttons=function(){t.prototype.buttons.call(this),this.summaryButton=s.default.makeButton("Summary",this.fireSummary.bind(this),this.card.buttons),this.action&&(this.actionButton=s.default.makeButton("Go",this.fireAction.bind(this),this.card.buttons,"ACTION"),document.createElement("button"))},e.prototype.fireAction=function(){window.open(this.action,"_blank")},e.prototype.fireSummary=function(){this.tree.summary(this)},e.prototype.fireNext=function(){this.hide(),this.tree.root.show(),this.tree.history=[]},e}(h);e.Leaf=f;var p=function(t){function e(){var e=t.call(this,"","Summary")||this;return e.kind="summary",e.nextName="Restart",e.summaryElement=s.default.makeDiv("SUMMARY"),e.card.content.appendChild(e.summaryElement),e}return i(e,t),e.prototype.fireNext=function(){this.hide(),this.tree.root.show(),this.tree.history=[]},e.prototype.show=function(){t.prototype.show.call(this),this.compileSummary()},e.prototype.compileSummary=function(){var t=this,e=0,n=this.tree.history.length,r=this.parent,i=[];this.summaryElement.innerHTML="";do{var o=e?r.labels.get(this.tree.history[n-e]):"";i.unshift(this.makeSummaryLine(r.content,o)),r=r.parent,e++}while(r);i.forEach((function(e){return t.summaryElement.appendChild(e)}))},e.prototype.makeSummaryLine=function(t,e){var n=s.default.makeDiv("SUMMARYLINE");return s.default.makeSpan(n,t,"QUESTION"),s.default.makeSpan(n,e,"ANSWER"),n},e}(h);e.Summary=p;var y=function(){function t(){this.div=s.default.makeDiv("NODE"),this.title=s.default.makeH1("TITLE"),this.content=s.default.makeDiv("CONTENT"),this.buttons=s.default.makeDiv("BUTTONS"),this.div.appendChild(this.title),this.title.setAttribute("tabindex","-1"),this.div.appendChild(this.content),this.content.setAttribute("tabindex","-1"),this.div.appendChild(this.buttons)}return t.prototype.show=function(){this.div.style.display="block",this.title.setAttribute("aria-live","polite"),this.content.setAttribute("tabindex","0"),this.title.setAttribute("tabindex","0"),this.title.focus()},t.prototype.hide=function(){this.div.style.display="none",this.title.removeAttribute("aria-live"),this.title.setAttribute("tabindex","-1"),this.content.setAttribute("tabindex","-1")},t}();e.Card=y},"./ts/util.ts":
/*!********************!*\
  !*** ./ts/util.ts ***!
  \********************/
/*! no static exports found */function(t,e,n){"use strict";var r,i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.makeButton=function(e,n,r,i){void 0===i&&(i="");var o=document.createElement("button");return o.innerHTML=e,t.addClass(o,i||e.toUpperCase(),"BUTTON"),o.addEventListener("click",n),r.appendChild(o),o};t.addClass=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];e.forEach((function(e){return t.classList.add("DT_"+e.toUpperCase())}))},t.makeDiv=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=document.createElement("div");return t.addClass.apply(void 0,o([r],e)),r},t.makeH1=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=document.createElement("h1");return t.addClass.apply(void 0,o([r],e)),r},t.makeSpan=function(e,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var a=document.createElement("span");t.addClass.apply(void 0,o([a],r)),a.innerHTML=n,e.appendChild(a)}}(r||(r={})),e.default=r}})}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZWNpc2lvbnRyZWUvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL2RlY2lzaW9udHJlZS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9kZWNpc2lvbnRyZWUvLi90cy9pbmRleC50cyIsIndlYnBhY2s6Ly9kZWNpc2lvbnRyZWUvLi90cy90cmVlLnRzIiwid2VicGFjazovL2RlY2lzaW9udHJlZS8uL3RzL3V0aWwudHMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwidGhpcyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJUcmVlIiwianNvblN0ciIsImhpc3RvcnkiLCJzdW1tYXJ5RWxlbWVudCIsIlN1bW1hcnkiLCJsb2FkSnNvbiIsInVybCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiaHR0cFJlcXVlc3QiLCJYTUxIdHRwUmVxdWVzdCIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJfbG9hZEpzb24iLCJyZXNwb25zZVRleHQiLCJzdGF0dXNUZXh0Iiwib25lcnJvciIsIm9wZW4iLCJzZW5kIiwianNvbiIsImZyb21Kc29uIiwiZXJyIiwiTm9kZSIsIkpTT04iLCJwYXJzZSIsIkRlcHRoRmlyc3QiLCJ4IiwicmVzdWx0IiwiZm9yRWFjaCIsInRyZWUiLCJwYXJlbnQiLCJ0b0hUTUwiLCJub2RlIiwicm9vdEVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsInRvSHRtbCIsImhpZGUiLCJzaG93Iiwic3VtbWFyeSIsImZ1bmMiLCJ2aXNpdCIsInB1c2giLCJjaGlsZHJlbiIsImNvbnRlbnQiLCJ0aXRsZSIsImxhYmVscyIsImtpbmQiLCJNYXAiLCJ2YXJpYWJsZSIsImNvdW50ZXIiLCJyYWRpb0J1dHRvbnMiLCJuZXh0TmFtZSIsInByZXZpb3VzTmFtZSIsImNhcmQiLCJDYXJkIiwidGV4dCIsInNldCIsInBhcnNlQ2hpbGRyZW4iLCJsZW5ndGgiLCJjaGlsZCIsImNoaWxkTm9kZSIsInR5cGUiLCJMZWFmIiwiYWN0aW9uIiwiTmFyeSIsIkJpbmFyeSIsIkVycm9yIiwiYWRkQ2xhc3MiLCJkaXYiLCJpbm5lckhUTUwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJyYWRpb3MiLCJidXR0b25zIiwibWFrZURpdiIsInJhZGlvIiwicmFkaW9JZCIsImxhYmVsQ291bnRlciIsImxhYmVsSWQiLCJpZCIsInRvU3RyaW5nIiwibGFiZWwiLCJzZXRBdHRyaWJ1dGUiLCJtYWtlQnV0dG9uIiwiZmlyZVByZXZpb3VzIiwiZmlyZU5leHQiLCJjaGVja2VkIiwibnVtIiwicGFyc2VJbnQiLCJzdW1tYXJ5QnV0dG9uIiwiZmlyZVN1bW1hcnkiLCJhY3Rpb25CdXR0b24iLCJmaXJlQWN0aW9uIiwid2luZG93IiwiY29tcGlsZVN1bW1hcnkiLCJjb3VudCIsImhsIiwiYW5zd2VyIiwidW5zaGlmdCIsIm1ha2VTdW1tYXJ5TGluZSIsInF1ZXN0aW9uIiwibWFrZVNwYW4iLCJtYWtlSDEiLCJzdHlsZSIsImRpc3BsYXkiLCJmb2N1cyIsInJlbW92ZUF0dHJpYnV0ZSIsIlV0aWwiLCJjbGFzc25hbWUiLCJidXR0b24iLCJ0b1VwcGVyQ2FzZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlbGVtZW50IiwicmVzdCIsImNs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QUFTQyxjQUFjLE1BRWpDLE9BREEsRUFBQUosU0FBUSxnQkFBQ0MsR0FBUXdDLElBQ1Z4QyxHQUdJLEVBQUFpQyxTQUFXLFNBQ3RCdkUsRUFBcUJhLEcsSUFBaUIsd0RBQ3RDLElBQUl5RSxFQUFPOUMsU0FBU0MsY0FBYyxRQUNsQyxFQUFBSixTQUFRLGdCQUFDaUQsR0FBU1IsSUFDbEJRLEVBQUsvQyxVQUFZMUIsRUFDakJiLEVBQU9JLFlBQVlrRixJQXBDdkIsQ0FBVVQsTUFBSSxLQXlDZCxVQUFlQSIsImZpbGUiOiJkZWNpc2lvbnRyZWUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJkZWNpc2lvbnRyZWVcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wiZGVjaXNpb250cmVlXCJdID0gZmFjdG9yeSgpO1xufSkodGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IFwiLi90cy9pbmRleC50c1wiKTtcbiIsImltcG9ydCB7VHJlZSBhcyBvYmowfSBmcm9tICcuL3RyZWUnO1xuXG5leHBvcnQgbGV0IFRyZWUgPSBvYmowO1xuIiwiLy8gICAgICAgICAgICAgICAgICAgIEdOVSBHRU5FUkFMIFBVQkxJQyBMSUNFTlNFXG4vLyAgICAgICAgICAgICAgICAgICAgICAgVmVyc2lvbiAzLCAyOSBKdW5lIDIwMDdcbi8vXG4vLyAgKGMpIDIwMjAgVm9sa2VyIFNvcmdlLCB2LnNvcmdlQHByb2dyZXNzaXZlYWNjZXNzLmNvbVxuLy8gICAgICAgICAgIEJlbmV0ZWNoICYgRVRTIGhhY2thdGhvblxuLy9cblxuaW1wb3J0IFV0aWwgZnJvbSAnLi91dGlsJztcblxuXG5cbi8qKlxuICogQmFzaWMgdHJlZSBjbGFzc1xuICovXG5leHBvcnQgY2xhc3MgVHJlZSB7XG5cbiAgcHVibGljIGpzb25TdHI6IHN0cmluZyA9ICcnO1xuICBwdWJsaWMgcm9vdDogTm9kZSA9IG51bGw7XG4gIHB1YmxpYyBoaXN0b3J5OiBudW1iZXJbXSA9IFtdO1xuICBwdWJsaWMgcm9vdEVsZW1lbnQ6IEhUTUxFbGVtZW50O1xuICBwdWJsaWMgc3VtbWFyeUVsZW1lbnQ6IFN1bW1hcnkgPSBuZXcgU3VtbWFyeSgpO1xuXG5cbiAgLyoqXG4gICAqIExvYWRzIEpzb24gZGF0YSBmcm9tIGEgVVJMLlxuICAgKiBAcmV0dXJuIFByb21pc2VcbiAgICovXG4gIHB1YmxpYyBsb2FkSnNvbih1cmw6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBsZXQgaHR0cFJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgIGh0dHBSZXF1ZXN0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoaHR0cFJlcXVlc3QucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgIGlmIChodHRwUmVxdWVzdC5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICAgICAgdGhpcy5fbG9hZEpzb24oaHR0cFJlcXVlc3QucmVzcG9uc2VUZXh0LCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoaHR0cFJlcXVlc3Quc3RhdHVzVGV4dCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LmJpbmQodGhpcyk7XG4gICAgICBodHRwUmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChodHRwUmVxdWVzdC5zdGF0dXNUZXh0KTtcbiAgICAgIH0uYmluZCh0aGlzKTtcbiAgICAgIGh0dHBSZXF1ZXN0Lm9wZW4oJ0dFVCcsIHVybCwgdHJ1ZSk7XG4gICAgICBodHRwUmVxdWVzdC5zZW5kKCk7XG4gICAgfSk7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBSZWNlaXZlcyBsb2FkZWQganNvbiBhbmQgcGFyc2VzIGl0IGludG8gdGhlIFRyZWUgc3RydWN0dXJlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30ganNvbiBUaGUgSlNPTiBzdHJpbmcuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IHJlc29sdmUgUHJvbWlzZSByZXNvbHV0aW9uLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSByZWplY3QgUHJvbWlzZSByZWplY3Rpb24uXG4gICAqL1xuICBwcm90ZWN0ZWQgX2xvYWRKc29uKGpzb246IHN0cmluZywgcmVzb2x2ZTogRnVuY3Rpb24sIHJlamVjdDogRnVuY3Rpb24pIHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5qc29uU3RyID0ganNvbjtcbiAgICAgIHRoaXMuZnJvbUpzb24oKTtcbiAgICAgIHJlc29sdmUoJ0pTT04gbG9hZGVkJyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZWplY3QoJ0pTT04gUGFyc2VyIEVycm9yIScpO1xuICAgIH1cbiAgfVxuXG5cbiAgLyoqXG4gICAqIFBhcnNlcyB0aGUgSlNPTi5cbiAgICovXG4gIHB1YmxpYyBmcm9tSnNvbigpIHtcbiAgICB0aGlzLnJvb3QgPSBOb2RlLmZyb21Kc29uKEpTT04ucGFyc2UodGhpcy5qc29uU3RyKSk7XG4gICAgbGV0IGRmcyA9IG5ldyBEZXB0aEZpcnN0KHRoaXMsICh4OiBOb2RlKSA9PiB4KTtcbiAgICBkZnMucmVzdWx0LmZvckVhY2gobiA9PiBuLnRyZWUgPSB0aGlzKTtcbiAgICB0aGlzLnN1bW1hcnlFbGVtZW50LnBhcmVudCA9IHRoaXMucm9vdDtcbiAgICB0aGlzLnN1bW1hcnlFbGVtZW50LnRyZWUgPSB0aGlzO1xuICB9XG5cblxuICAvKipcbiAgICogQXR0YWNoZXMgdGhlIHRyZWUgRE9NIHRvIGFuIGV4aXN0aW5nIG5vZGUuXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IG5vZGUgVGhlIERPTSBub2RlLlxuICAgKi9cbiAgcHVibGljIHRvSFRNTChub2RlOiBIVE1MRWxlbWVudCkge1xuICAgIHRoaXMucm9vdEVsZW1lbnQgPSBub2RlO1xuICAgIGxldCBkZnMgPSBuZXcgRGVwdGhGaXJzdCh0aGlzLCAoeDogTm9kZSkgPT4geCk7XG4gICAgZGZzLnJlc3VsdC5mb3JFYWNoKChuOiBOb2RlKSA9PiB7XG4gICAgICBub2RlLmFwcGVuZENoaWxkKG4udG9IdG1sKCkpO1xuICAgICAgbi5oaWRlKCk7XG4gICAgfSk7XG4gICAgbm9kZS5hcHBlbmRDaGlsZCh0aGlzLnN1bW1hcnlFbGVtZW50LnRvSHRtbCgpKTtcbiAgICB0aGlzLnN1bW1hcnlFbGVtZW50LmhpZGUoKTtcbiAgICB0aGlzLnJvb3Quc2hvdygpO1xuICB9XG5cblxuICAvKipcbiAgICogR2VuZXJhdGUgYSBzdW1tYXJ5IG9mIHRoZSBkZWNpc2lvbiBwYXRoLlxuICAgKiBAcGFyYW0ge05vZGV9IG5vZGUgVGhlIGxlYWYgbm9kZS5cbiAgICovXG4gIHB1YmxpYyBzdW1tYXJ5KG5vZGU6IE5vZGUpIHtcbiAgICBub2RlLmhpZGUoKTtcbiAgICB0aGlzLnN1bW1hcnlFbGVtZW50LnBhcmVudCA9IG5vZGU7XG4gICAgdGhpcy5zdW1tYXJ5RWxlbWVudC5zaG93KCk7XG4gIH1cblxufVxuXG5cbi8qKlxuICogQSBEZXB0aCBGaXJzdCBWaXNpdG9yIGZvciB0aGUgVHJlZS5cbiAqL1xuZXhwb3J0IGNsYXNzIERlcHRoRmlyc3Qge1xuXG4gIHB1YmxpYyByZXN1bHQ6IGFueVtdID0gW107XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge1RyZWV9IHRyZWUgVGhlIHRyZWUgdG8gdmlzaXQuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIHZpc2l0aW5nIG1ldGhvZC5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHRyZWU6IFRyZWUsIHByaXZhdGUgZnVuYzogRnVuY3Rpb24pIHtcbiAgICB0aGlzLnZpc2l0KHRyZWUucm9vdCk7XG4gIH1cblxuICAvKipcbiAgICogREYgd2Fsa2luZyBvZiB0aGUgdHJlZS5cbiAgICogQHBhcmFtIHtOb2RlfSBub2RlIFRoZSBjdXJyZW50IG5vZGUuXG4gICAqL1xuICBwcml2YXRlIHZpc2l0KG5vZGU6IE5vZGUpIHtcbiAgICB0aGlzLnJlc3VsdC5wdXNoKHRoaXMuZnVuYyhub2RlKSk7XG4gICAgbm9kZS5jaGlsZHJlbi5mb3JFYWNoKHggPT4gdGhpcy52aXNpdCh4KSk7XG4gIH1cblxufVxuXG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBOb2RlIHtcblxuICBzdGF0aWMgY291bnRlciA9IDA7XG4gIHN0YXRpYyBsYWJlbENvdW50ZXIgPSAwO1xuXG5cblxuICBwdWJsaWMga2luZDogc3RyaW5nID0gJyc7XG4gIHB1YmxpYyB0cmVlOiBUcmVlO1xuICBwdWJsaWMgbGFiZWxzOiBNYXA8bnVtYmVyLCBzdHJpbmc+ID0gbmV3IE1hcDxudW1iZXIsIHN0cmluZz4oKTtcbiAgcHVibGljIGNoaWxkcmVuOiBNYXA8bnVtYmVyLCBOb2RlPiA9IG5ldyBNYXA8bnVtYmVyLCBOb2RlPigpO1xuICBwdWJsaWMgcGFyZW50OiBOb2RlID0gbnVsbDtcbiAgcHVibGljIHZhcmlhYmxlOiBzdHJpbmcgPSAnZHRfdmFyaWFibGVfJyArIE5vZGUuY291bnRlcisrO1xuICBwdWJsaWMgY2FyZDogQ2FyZDtcbiAgcHVibGljIHJhZGlvQnV0dG9uczogSFRNTEVsZW1lbnRbXSA9IFtdO1xuXG4gIHB1YmxpYyBuZXh0TmFtZTogc3RyaW5nID0gJ05leHQnO1xuICBwdWJsaWMgcHJldmlvdXNOYW1lOiBzdHJpbmcgPSAnQmFjayc7XG5cbiAgY29uc3RydWN0b3IocHVibGljIGNvbnRlbnQ6IHN0cmluZywgcHVibGljIHRpdGxlOiBzdHJpbmcgPSAnJyxcbiAgICAgICAgICAgICAgcHVibGljIHZhbHVlID0gMCxcbiAgICAgICAgICAgICAgbGFiZWxzOiB7dGV4dDogc3RyaW5nLCB2YWx1ZTogbnVtYmVyfVtdID0gW10pIHtcbiAgICB0aGlzLmNhcmQgPSBuZXcgQ2FyZCgpO1xuICAgIGZvciAobGV0IHt0ZXh0OiB0ZXh0LCB2YWx1ZTogdmFsdWV9IG9mIGxhYmVscykge1xuICAgICAgdGhpcy5sYWJlbHMuc2V0KHZhbHVlLCB0ZXh0KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBwYXJzZUNoaWxkcmVuKG5vZGU6IE5vZGUsIGpzb246IGFueVtdKSB7XG4gICAgaWYgKCFqc29uIHx8ICFqc29uLmxlbmd0aCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIGpzb24pIHtcbiAgICAgIGxldCBjaGlsZE5vZGUgPSBOb2RlLmZyb21Kc29uKGNoaWxkKTtcbiAgICAgIG5vZGUuY2hpbGRyZW4uc2V0KGNoaWxkTm9kZS52YWx1ZSwgY2hpbGROb2RlKTtcbiAgICAgIGNoaWxkTm9kZS5wYXJlbnQgPSBub2RlO1xuICAgIH1cbiAgfVxuXG4gIHN0YXRpYyBmcm9tSnNvbihqc29uOiBhbnkpOiBOb2RlIHtcbiAgICBsZXQga2luZCA9IGpzb24udHlwZSB8fCAnbGVhZic7XG4gICAgbGV0IG5vZGU6IE5vZGUgPSBudWxsO1xuICAgIHN3aXRjaCAoa2luZCkge1xuICAgICAgY2FzZSAnbGVhZic6XG4gICAgICAgIG5vZGUgPSBuZXcgTGVhZihqc29uLmNvbnRlbnQsIGpzb24udGl0bGUsIGpzb24udmFsdWUsIGpzb24uYWN0aW9uKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICduYXJ5JzpcbiAgICAgICAgbm9kZSA9IG5ldyBOYXJ5KGpzb24uY29udGVudCwganNvbi50aXRsZSwganNvbi52YWx1ZSwganNvbi5sYWJlbHMgfHwgW10pO1xuICAgICAgICBOb2RlLnBhcnNlQ2hpbGRyZW4obm9kZSwganNvbi5jaGlsZHJlbik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnYmluYXJ5JzpcbiAgICAgICAgbm9kZSA9IG5ldyBCaW5hcnkoanNvbi5jb250ZW50LCBqc29uLnRpdGxlLCBqc29uLnZhbHVlKTtcbiAgICAgICAgTm9kZS5wYXJzZUNoaWxkcmVuKG5vZGUsIGpzb24uY2hpbGRyZW4pO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IEVycm9yKCdVbmtub3duIG5vZGUgdHlwZS4nKTtcbiAgICB9XG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cblxuICBwdWJsaWMgdG9IdG1sKCk6IEhUTUxFbGVtZW50IHtcbiAgICBVdGlsLmFkZENsYXNzKHRoaXMuY2FyZC5kaXYsIHRoaXMua2luZCk7XG4gICAgLy8gQWN0dWFsIHRpdGxlIGVsZW1lbnRcbiAgICB0aGlzLmNhcmQudGl0bGUuaW5uZXJIVE1MID0gdGhpcy50aXRsZTtcbiAgICAvLyBBY3R1YWwgY29udGVudCBlbGVtZW50XG4gICAgbGV0IGNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgVXRpbC5hZGRDbGFzcyhjb250ZW50LCAnQ09OVEVOVCcpO1xuICAgIGNvbnRlbnQuaW5uZXJIVE1MID0gdGhpcy5jb250ZW50O1xuICAgIHRoaXMuY2FyZC5jb250ZW50LmFwcGVuZENoaWxkKGNvbnRlbnQpO1xuICAgIHRoaXMucmFkaW9zKCk7XG4gICAgdGhpcy5idXR0b25zKCk7XG4gICAgcmV0dXJuIHRoaXMuY2FyZC5kaXY7XG4gIH1cblxuXG4gIHByb3RlY3RlZCByYWRpb3MoKSB7XG4gICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgdGhpcy5sYWJlbHMpIHtcbiAgICAgIGxldCBjb250ZW50ID0gVXRpbC5tYWtlRGl2KCdSQURJT0JVVFRPTicpO1xuICAgICAgbGV0IHJhZGlvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgIFV0aWwuYWRkQ2xhc3MocmFkaW8sICdSQURJTycpO1xuICAgICAgbGV0IHJhZGlvSWQgPSAnZHRfaWRfJyArIE5vZGUubGFiZWxDb3VudGVyKys7XG4gICAgICBsZXQgbGFiZWxJZCA9ICdkdF9pZF8nICsgTm9kZS5sYWJlbENvdW50ZXIrKztcbiAgICAgIHJhZGlvLnR5cGUgPSAncmFkaW8nO1xuICAgICAgcmFkaW8uaWQgPSByYWRpb0lkO1xuICAgICAgcmFkaW8ubmFtZSA9IHRoaXMudmFyaWFibGU7XG4gICAgICByYWRpby52YWx1ZSA9IGtleS50b1N0cmluZygpO1xuICAgICAgdGhpcy5yYWRpb0J1dHRvbnMucHVzaChyYWRpbyk7XG4gICAgICBsZXQgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xuICAgICAgVXRpbC5hZGRDbGFzcyhsYWJlbCwgJ0xBQkVMJyk7XG4gICAgICBsYWJlbC5pZCA9IGxhYmVsSWQ7XG4gICAgICBsYWJlbC5zZXRBdHRyaWJ1dGUoJ2ZvcicsIHJhZGlvSWQpO1xuICAgICAgbGFiZWwuaW5uZXJIVE1MID0gdmFsdWU7XG4gICAgICBjb250ZW50LmFwcGVuZENoaWxkKHJhZGlvKTtcbiAgICAgIGNvbnRlbnQuYXBwZW5kQ2hpbGQobGFiZWwpO1xuICAgICAgdGhpcy5jYXJkLmNvbnRlbnQuYXBwZW5kQ2hpbGQoY29udGVudCk7XG4gICAgfVxuICB9XG5cbiAgcHJvdGVjdGVkIGJ1dHRvbnMoKSB7XG4gICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICBVdGlsLm1ha2VCdXR0b24oXG4gICAgICAgIHRoaXMucHJldmlvdXNOYW1lLCB0aGlzLmZpcmVQcmV2aW91cy5iaW5kKHRoaXMpLCB0aGlzLmNhcmQuYnV0dG9ucywgJ1BSRVZJT1VTJyk7XG4gICAgfVxuICAgIFV0aWwubWFrZUJ1dHRvbih0aGlzLm5leHROYW1lLCB0aGlzLmZpcmVOZXh0LmJpbmQodGhpcyksIHRoaXMuY2FyZC5idXR0b25zLCAnTkVYVCcpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGZpcmVOZXh0KCkge1xuICAgIGZvciAobGV0IHJhZGlvIG9mIHRoaXMucmFkaW9CdXR0b25zKSB7XG4gICAgICBpZiAoKHJhZGlvIGFzIGFueSkuY2hlY2tlZCkge1xuICAgICAgICBsZXQgdmFsdWUgPSAocmFkaW8gYXMgYW55KS52YWx1ZTtcbiAgICAgICAgbGV0IG51bSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG4gICAgICAgIHRoaXMudHJlZS5oaXN0b3J5LnB1c2gobnVtKTtcbiAgICAgICAgdGhpcy5oaWRlKCk7XG4gICAgICAgIHRoaXMuY2hpbGRyZW4uZ2V0KG51bSkuc2hvdygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJvdGVjdGVkIGZpcmVQcmV2aW91cygpIHtcbiAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgdGhpcy5wYXJlbnQuc2hvdygpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBzaG93KCkge1xuICAgIHRoaXMuY2FyZC5zaG93KCk7XG4gIH1cblxuICBwdWJsaWMgaGlkZSgpIHtcbiAgICB0aGlzLmNhcmQuaGlkZSgpO1xuICB9XG5cbn1cblxuZXhwb3J0IGNsYXNzIEJpbmFyeSBleHRlbmRzIE5vZGUge1xuXG4gIC8qKlxuICAgKiBAb3ZlcnJpZGVcbiAgICovXG4gIHB1YmxpYyBraW5kID0gJ2JpbmFyeSc7XG5cbiAgY29uc3RydWN0b3IocHVibGljIGNvbnRlbnQ6IHN0cmluZywgcHVibGljIHRpdGxlOiBzdHJpbmcsIHB1YmxpYyB2YWx1ZSA9IDApIHtcbiAgICBzdXBlcihjb250ZW50LCB0aXRsZSwgdmFsdWUsXG4gICAgICAgICAgW3t0ZXh0OiAnWWVzJywgdmFsdWU6IDF9LCB7dGV4dDogJ05vJywgdmFsdWU6IDB9XSk7XG4gIH1cblxufVxuXG5cbmV4cG9ydCBjbGFzcyBOYXJ5IGV4dGVuZHMgTm9kZSB7XG4gIHB1YmxpYyBraW5kID0gJ25hcnknXG5cbn1cblxuXG5leHBvcnQgY2xhc3MgTGVhZiBleHRlbmRzIE5vZGUge1xuICBwdWJsaWMga2luZCA9ICdsZWFmJztcbiAgcHVibGljIG5leHROYW1lID0gJ1Jlc3RhcnQnO1xuICBwdWJsaWMgc3VtbWFyeUJ1dHRvbjogSFRNTEVsZW1lbnQ7XG4gIHB1YmxpYyBhY3Rpb25CdXR0b246IEhUTUxFbGVtZW50O1xuXG4gIGNvbnN0cnVjdG9yKGNvbnRlbnQ6IHN0cmluZywgdGl0bGU6IHN0cmluZywgdmFsdWU6IG51bWJlcixcbiAgICAgICAgICAgICAgcHVibGljIGFjdGlvbjogc3RyaW5nID0gJycpIHtcbiAgICBzdXBlcihjb250ZW50LCB0aXRsZSwgdmFsdWUpO1xuICB9XG5cblxuICBwcm90ZWN0ZWQgYnV0dG9ucygpIHtcbiAgICBzdXBlci5idXR0b25zKCk7XG4gICAgdGhpcy5zdW1tYXJ5QnV0dG9uID0gVXRpbC5tYWtlQnV0dG9uKFxuICAgICAgJ1N1bW1hcnknLCB0aGlzLmZpcmVTdW1tYXJ5LmJpbmQodGhpcyksIHRoaXMuY2FyZC5idXR0b25zKTtcbiAgICBpZiAodGhpcy5hY3Rpb24pIHtcbiAgICAgIHRoaXMuYWN0aW9uQnV0dG9uID0gVXRpbC5tYWtlQnV0dG9uKFxuICAgICAgICAnR28nLCB0aGlzLmZpcmVBY3Rpb24uYmluZCh0aGlzKSwgdGhpcy5jYXJkLmJ1dHRvbnMsICdBQ1RJT04nKTtcbiAgICAgIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCBmaXJlQWN0aW9uKCkge1xuICAgIHdpbmRvdy5vcGVuKHRoaXMuYWN0aW9uLCAnX2JsYW5rJyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZmlyZVN1bW1hcnkoKSB7XG4gICAgdGhpcy50cmVlLnN1bW1hcnkodGhpcyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZmlyZU5leHQoKSB7XG4gICAgdGhpcy5oaWRlKCk7XG4gICAgdGhpcy50cmVlLnJvb3Quc2hvdygpO1xuICAgIHRoaXMudHJlZS5oaXN0b3J5ID0gW107XG4gIH1cblxufVxuXG5cbmV4cG9ydCBjbGFzcyBTdW1tYXJ5IGV4dGVuZHMgTm9kZSB7XG5cbiAgcHVibGljIGtpbmQgPSAnc3VtbWFyeSc7XG4gIHB1YmxpYyBuZXh0TmFtZSA9ICdSZXN0YXJ0JztcbiAgcHVibGljIHN1bW1hcnlFbGVtZW50ID0gVXRpbC5tYWtlRGl2KCdTVU1NQVJZJyk7XG4gIFxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcignJywgJ1N1bW1hcnknKTtcbiAgICB0aGlzLmNhcmQuY29udGVudC5hcHBlbmRDaGlsZCh0aGlzLnN1bW1hcnlFbGVtZW50KTtcbiAgfVxuXG4gIHByb3RlY3RlZCBmaXJlTmV4dCgpIHtcbiAgICB0aGlzLmhpZGUoKTtcbiAgICB0aGlzLnRyZWUucm9vdC5zaG93KCk7XG4gICAgdGhpcy50cmVlLmhpc3RvcnkgPSBbXTtcbiAgfVxuXG4gIHB1YmxpYyBzaG93KCkge1xuICAgIHN1cGVyLnNob3coKTtcbiAgICB0aGlzLmNvbXBpbGVTdW1tYXJ5KCk7XG4gIH1cblxuICBwcml2YXRlIGNvbXBpbGVTdW1tYXJ5KCkge1xuICAgIGxldCBjb3VudCA9IDA7XG4gICAgbGV0IGhsID0gdGhpcy50cmVlLmhpc3RvcnkubGVuZ3RoO1xuICAgIGxldCBub2RlID0gdGhpcy5wYXJlbnQ7XG4gICAgbGV0IHJlc3VsdCA9IFtdO1xuICAgIHRoaXMuc3VtbWFyeUVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XG4gICAgZG8ge1xuICAgICAgbGV0IGFuc3dlciA9IGNvdW50ID8gbm9kZS5sYWJlbHMuZ2V0KHRoaXMudHJlZS5oaXN0b3J5W2hsIC0gY291bnRdKSA6ICcnO1xuICAgICAgcmVzdWx0LnVuc2hpZnQodGhpcy5tYWtlU3VtbWFyeUxpbmUobm9kZS5jb250ZW50LCBhbnN3ZXIpKTtcbiAgICAgIG5vZGUgPSBub2RlLnBhcmVudDtcbiAgICAgIGNvdW50Kys7XG4gICAgfSB3aGlsZSAobm9kZSk7XG4gICAgcmVzdWx0LmZvckVhY2goeCA9PiB0aGlzLnN1bW1hcnlFbGVtZW50LmFwcGVuZENoaWxkKHgpKTtcbiAgfVxuXG4gIHByaXZhdGUgbWFrZVN1bW1hcnlMaW5lKHF1ZXN0aW9uOiBzdHJpbmcsIGFuc3dlcjogc3RyaW5nKTogSFRNTEVsZW1lbnQge1xuICAgIGxldCBkaXYgPSBVdGlsLm1ha2VEaXYoJ1NVTU1BUllMSU5FJyk7XG4gICAgVXRpbC5tYWtlU3BhbihkaXYsIHF1ZXN0aW9uLCAnUVVFU1RJT04nKTtcbiAgICBVdGlsLm1ha2VTcGFuKGRpdiwgYW5zd2VyLCAnQU5TV0VSJyk7XG4gICAgcmV0dXJuIGRpdjtcbiAgfVxuXG59XG5cbmV4cG9ydCBjbGFzcyBDYXJkIHtcblxuICBwdWJsaWMgZGl2OiBIVE1MRWxlbWVudCA9IFV0aWwubWFrZURpdignTk9ERScpO1xuICBwdWJsaWMgdGl0bGU6IEhUTUxFbGVtZW50ID0gVXRpbC5tYWtlSDEoJ1RJVExFJyk7XG4gIHB1YmxpYyBjb250ZW50OiBIVE1MRWxlbWVudCA9IFV0aWwubWFrZURpdignQ09OVEVOVCcpXG4gIHB1YmxpYyBidXR0b25zOiBIVE1MRWxlbWVudCA9IFV0aWwubWFrZURpdignQlVUVE9OUycpO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZGl2LmFwcGVuZENoaWxkKHRoaXMudGl0bGUpO1xuICAgIHRoaXMudGl0bGUuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xuICAgIHRoaXMuZGl2LmFwcGVuZENoaWxkKHRoaXMuY29udGVudCk7XG4gICAgdGhpcy5jb250ZW50LnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcbiAgICB0aGlzLmRpdi5hcHBlbmRDaGlsZCh0aGlzLmJ1dHRvbnMpO1xuICB9XG5cbiAgcHVibGljIHNob3coKSB7XG4gICAgdGhpcy5kaXYuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgdGhpcy50aXRsZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGl2ZScsICdwb2xpdGUnKTtcbiAgICB0aGlzLmNvbnRlbnQuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICcwJyk7XG4gICAgdGhpcy50aXRsZS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJzAnKTtcbiAgICB0aGlzLnRpdGxlLmZvY3VzKCk7XG4gIH1cblxuICBwdWJsaWMgaGlkZSgpIHtcbiAgICB0aGlzLmRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIHRoaXMudGl0bGUucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWxpdmUnKTtcbiAgICB0aGlzLnRpdGxlLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcbiAgICB0aGlzLmNvbnRlbnQuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xuICB9XG5cbn1cbiIsIm5hbWVzcGFjZSBVdGlsIHtcblxuICBleHBvcnQgY29uc3QgbWFrZUJ1dHRvbiA9IGZ1bmN0aW9uKFxuICAgIG5hbWU6IHN0cmluZywgYWN0aW9uOiAoKSA9PiBhbnksIHBhcmVudDogSFRNTEVsZW1lbnQsXG4gICAgY2xhc3NuYW1lOiBzdHJpbmcgPSAnJyk6IEhUTUxCdXR0b25FbGVtZW50IHtcbiAgICBsZXQgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgYnV0dG9uLmlubmVySFRNTCA9IG5hbWU7XG4gICAgYWRkQ2xhc3MoYnV0dG9uLCBjbGFzc25hbWUgfHwgbmFtZS50b1VwcGVyQ2FzZSgpLCAnQlVUVE9OJyk7XG4gICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYWN0aW9uKTtcbiAgICBwYXJlbnQuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcbiAgICByZXR1cm4gYnV0dG9uO1xuICB9O1xuXG4gIGxldCBwcmVmaXggPSAnRFRfJztcblxuICBleHBvcnQgY29uc3QgYWRkQ2xhc3MgPSBmdW5jdGlvbihlbGVtZW50OiBIVE1MRWxlbWVudCwgLi4ucmVzdDogc3RyaW5nW10pIHtcbiAgICByZXN0LmZvckVhY2goeCA9PiBlbGVtZW50LmNsYXNzTGlzdC5hZGQocHJlZml4ICsgeC50b1VwcGVyQ2FzZSgpKSk7XG4gIH07XG5cbiAgZXhwb3J0IGNvbnN0IG1ha2VEaXYgPSBmdW5jdGlvbiguLi5jbGFzc25hbWU6IHN0cmluZ1tdKSB7XG4gICAgbGV0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGFkZENsYXNzKGRpdiwgLi4uY2xhc3NuYW1lKTtcbiAgICByZXR1cm4gZGl2O1xuICB9O1xuXG4gIGV4cG9ydCBjb25zdCBtYWtlSDEgPSBmdW5jdGlvbiguLi5jbGFzc25hbWU6IHN0cmluZ1tdKSB7XG4gICAgbGV0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gxJyk7XG4gICAgYWRkQ2xhc3MoZGl2LCAuLi5jbGFzc25hbWUpO1xuICAgIHJldHVybiBkaXY7XG4gIH07XG5cbiAgZXhwb3J0IGNvbnN0IG1ha2VTcGFuID0gZnVuY3Rpb24oXG4gICAgcGFyZW50OiBIVE1MRWxlbWVudCwgY29udGVudDogc3RyaW5nLCAuLi5jbGFzc25hbWU6IHN0cmluZ1tdKSB7XG4gICAgbGV0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgYWRkQ2xhc3Moc3BhbiwgLi4uY2xhc3NuYW1lKTtcbiAgICBzcGFuLmlubmVySFRNTCA9IGNvbnRlbnQ7XG4gICAgcGFyZW50LmFwcGVuZENoaWxkKHNwYW4pO1xuICB9O1xuXG59XG5cbmV4cG9ydCBkZWZhdWx0IFV0aWw7XG4iXSwic291cmNlUm9vdCI6IiJ9