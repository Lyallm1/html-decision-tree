!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.decisiontree=e():t.decisiontree=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./ts/index.ts")}({"./ts/index.ts":
/*!*********************!*\
  !*** ./ts/index.ts ***!
  \*********************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tree=void 0;var r=n(/*! ./tree */"./ts/tree.ts");e.Tree=r.Tree},"./ts/tree.ts":
/*!********************!*\
  !*** ./ts/tree.ts ***!
  \********************/
/*! no static exports found */function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},s=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0}),e.Card=e.Leaf=e.Nary=e.Binary=e.Node=e.DepthFirst=e.Tree=void 0;var u=n(/*! ./util */"./ts/util.ts"),l=function(){function t(){this.jsonStr="",this.root=null,this.history=[]}return t.prototype.loadJson=function(t){var e=this;return new Promise((function(n,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&(200===i.status?this._loadJson(i.responseText,n,r):r(i.statusText))}.bind(e),i.onerror=function(){r(i.statusText)}.bind(e),i.open("GET",t,!0),i.send()}))},t.prototype._loadJson=function(t,e,n){try{this.jsonStr=t,this.fromJson(),e("JSON loaded")}catch(t){n("JSON Parser Error!")}},t.prototype.fromJson=function(){var t=this;this.root=f.fromJson(JSON.parse(this.jsonStr)),new d(this,(function(t){return t})).result.forEach((function(e){return e.tree=t}))},t.prototype.toHTML=function(t){void 0===t&&(t=null),this.rootElement=t,new d(this,(function(t){return t})).result.forEach((function(e){t.appendChild(e.toHtml()),e.hide()})),this.root.show()},t.prototype.summary=function(t){t.hide();var e=[[t.content,""]],n=0;for(t=t.parent;t;){n++;var r=this.history[this.history.length-n];e.unshift([t.content,t.labels.get(r)]),t=t.parent}this.printSummary(e)},t.prototype.printSummary=function(t){var e,n;this.summaryElement=document.createElement("div"),u.default.addClass(this.summaryElement,"NODE","SUMMARY"),this.rootElement.appendChild(this.summaryElement);var r=document.createElement("span");u.default.addClass(r,"TITLE"),r.setAttribute("tabindex","-1"),r.innerHTML="Summary",this.summaryElement.appendChild(r);try{for(var i=o(t),s=i.next();!s.done;s=i.next()){var l=a(s.value,2),d=l[0],c=l[1],h=document.createElement("div"),f=document.createElement("span");f.innerHTML=d,h.appendChild(f);var p=document.createElement("span");p.innerHTML=c,h.appendChild(p),this.summaryElement.appendChild(h)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}this.summaryElement.style.display="block"},t}();e.Tree=l;var d=function(){function t(t,e){this.func=e,this.result=[],this.visit(t.root)}return t.prototype.visit=function(t){var e=this;this.result.push(this.func(t)),t.children.forEach((function(t){return e.visit(t)}))},t}();e.DepthFirst=d;var c=0,h=0,f=function(){function t(t,e,n,r){var i,a;void 0===e&&(e=""),void 0===n&&(n=0),void 0===r&&(r=[]),this.content=t,this.title=e,this.value=n,this.labels=new Map,this.kind="",this.children=new Map,this.parent=null,this.variable="dt_variable_"+c++,this.radioButtons=[],this.nextName="Next",this.previousName="Back",this.card=new b;try{for(var s=o(r),u=s.next();!u.done;u=s.next()){var l=u.value,d=l.text,h=l.value;this.labels.set(h,d)}}catch(t){i={error:t}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}}return t.parseChildren=function(e,n){var r,i;if(n&&n.length)try{for(var a=o(n),s=a.next();!s.done;s=a.next()){var u=s.value,l=t.fromJson(u);e.children.set(l.value,l),l.parent=e}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},t.fromJson=function(e){var n=null;switch(e.type||"leaf"){case"leaf":n=new v(e.content,e.title,e.value,e.action);break;case"nary":n=new y(e.content,e.title,e.value,e.labels||[]),t.parseChildren(n,e.children);break;case"binary":n=new p(e.content,e.title,e.value),t.parseChildren(n,e.children);break;default:throw Error("Unknown node type.")}return n},t.prototype.toHtml=function(){u.default.addClass(this.card.div,this.kind),this.card.title.innerHTML=this.title;var t=document.createElement("span");return u.default.addClass(t,"CONTENT"),t.innerHTML=this.content,this.card.content.appendChild(t),this.radios(),this.buttons(),this.card.div},t.prototype.radios=function(){var t,e;try{for(var n=o(this.labels),r=n.next();!r.done;r=n.next()){var i=a(r.value,2),s=i[0],l=i[1],d=document.createElement("div");u.default.addClass(d,"RADIOBUTTON");var c=document.createElement("input");u.default.addClass(c,"RADIO");var f="dt_id_"+h++,p="dt_id_"+h++;c.type="radio",c.id=f,c.name=this.variable,c.value=s.toString(),c.setAttribute("aria-labelledby",p),this.radioButtons.push(c);var y=document.createElement("label");u.default.addClass(y,"LABEL"),y.id=p,y.setAttribute("for",f),y.innerHTML=l,d.appendChild(c),d.appendChild(y),this.card.content.appendChild(d)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.buttons=function(){this.parent&&u.default.makeButton(this.previousName,this.firePrevious.bind(this),this.card.buttons,"PREVIOUS"),u.default.makeButton(this.nextName,this.fireNext.bind(this),this.card.buttons,"NEXT")},t.prototype.fireNext=function(){var t,e;try{for(var n=o(this.radioButtons),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.checked){var a=i.value,s=parseInt(a,10);return this.tree.history.push(s),this.hide(),void this.children.get(s).show()}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.firePrevious=function(){this.parent&&(this.hide(),this.parent.show())},t.prototype.show=function(){this.card.show()},t.prototype.hide=function(){this.card.hide()},t}();e.Node=f;var p=function(t){function e(e,n,r){void 0===r&&(r=0);var i=t.call(this,e,n,r,[{text:"Yes",value:1},{text:"No",value:0}])||this;return i.content=e,i.title=n,i.value=r,i.kind="binary",i}return i(e,t),e}(f);e.Binary=p;var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.kind="nary",e}return i(e,t),e}(f);e.Nary=y;var v=function(t){function e(e,n,r,i){void 0===i&&(i="");var o=t.call(this,e,n,r)||this;return o.action=i,o.kind="leaf",o.nextName="Restart",o}return i(e,t),e.prototype.buttons=function(){t.prototype.buttons.call(this),this.summaryButton=u.default.makeButton("Summary",this.fireSummary.bind(this),this.card.buttons),this.action&&(this.actionButton=u.default.makeButton("Go",this.fireAction.bind(this),this.card.buttons,"ACTION"),document.createElement("button"))},e.prototype.fireAction=function(){console.log("Firing!"),window.open(this.action,"_blank")},e.prototype.fireSummary=function(){this.tree.summary(this)},e.prototype.fireNext=function(){this.hide(),this.tree.root.show(),this.tree.history=[]},e}(f);e.Leaf=v;var m=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=document.createElement("div");return u.default.addClass.apply(u.default,s([n],t)),n},b=function(){function t(){this.div=m("NODE"),this.title=m("TITLE"),this.content=m("CONTENT"),this.buttons=m("BUTTONS"),this.div.appendChild(this.title),this.title.setAttribute("tabindex","-1"),this.div.appendChild(this.content),this.content.setAttribute("tabindex","-1"),this.div.appendChild(this.buttons)}return t.prototype.show=function(){this.div.style.display="block",this.content.setAttribute("tabindex","0"),this.title.setAttribute("aria-live","polite"),this.title.setAttribute("tabindex","0")},t.prototype.hide=function(){this.div.style.display="none",this.content.setAttribute("tabindex","-1"),this.title.removeAttribute("aria-live"),this.title.setAttribute("tabindex","-1")},t}();e.Card=b},"./ts/util.ts":
/*!********************!*\
  !*** ./ts/util.ts ***!
  \********************/
/*! no static exports found */function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.makeButton=function(e,n,r,i){void 0===i&&(i="");var o=document.createElement("button");return o.innerHTML=e,t.addClass(o,i||e.toUpperCase()),o.addEventListener("click",n),r.appendChild(o),o};t.addClass=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];e.forEach((function(e){return t.classList.add("DT_"+e.toUpperCase())}))}}(r||(r={})),e.default=r}})}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZWNpc2lvbnRyZWUvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL2RlY2lzaW9udHJlZS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9kZWNpc2lvbnRyZWUvLi90cy9pbmRleC50cyIsIndlYnBhY2s6Ly9kZWNpc2lvbnRyZWUvLi90cy90cmVlLnRzIiwid2VicGFjazovL2RlY2lzaW9udHJlZS8uL3RzL3V0aWwudHMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwidGhpcyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJUcmVlIiwianNvblN0ciIsImhpc3RvcnkiLCJsb2FkSnNvbiIsInVybCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiaHR0cFJlcXVlc3QiLCJYTUxIdHRwUmVxdWVzdCIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJfbG9hZEpzb24iLCJyZXNwb25zZVRleHQiLCJzdGF0dXNUZXh0Iiwib25lcnJvciIsIm9wZW4iLCJzZW5kIiwianNvbiIsImZyb21Kc29uIiwiZXJyIiwiTm9kZSIsIkpTT04iLCJwYXJzZSIsIkRlcHRoRmlyc3QiLCJ4IiwicmVzdWx0IiwiZm9yRWFjaCIsInRyZWUiLCJ0b0hUTUwiLCJub2RlIiwicm9vdEVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsInRvSHRtbCIsImhpZGUiLCJzaG93Iiwic3VtbWFyeSIsImNvbnRlbnQiLCJjb3VudCIsInBhcmVudCIsImxlbmd0aCIsInVuc2hpZnQiLCJsYWJlbHMiLCJwcmludFN1bW1hcnkiLCJzdW1tYXJ5RWxlbWVudCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImFkZENsYXNzIiwidGl0bGUiLCJzZXRBdHRyaWJ1dGUiLCJpbm5lckhUTUwiLCJxdWVzdGlvbiIsImRpdiIsInNwYW4xIiwic3BhbjIiLCJzdHlsZSIsImRpc3BsYXkiLCJmdW5jIiwidmlzaXQiLCJwdXNoIiwiY2hpbGRyZW4iLCJjb3VudGVyIiwibGFiZWxDb3VudGVyIiwiTWFwIiwia2luZCIsInZhcmlhYmxlIiwicmFkaW9CdXR0b25zIiwibmV4dE5hbWUiLCJwcmV2aW91c05hbWUiLCJjYXJkIiwiQ2FyZCIsInRleHQiLCJzZXQiLCJwYXJzZUNoaWxkcmVuIiwiY2hpbGQiLCJjaGlsZE5vZGUiLCJ0eXBlIiwiTGVhZiIsImFjdGlvbiIsIk5hcnkiLCJCaW5hcnkiLCJFcnJvciIsInJhZGlvcyIsImJ1dHRvbnMiLCJyYWRpbyIsInJhZGlvSWQiLCJsYWJlbElkIiwiaWQiLCJ0b1N0cmluZyIsImxhYmVsIiwibWFrZUJ1dHRvbiIsImZpcmVQcmV2aW91cyIsImZpcmVOZXh0IiwiY2hlY2tlZCIsIm51bSIsInBhcnNlSW50Iiwic3VtbWFyeUJ1dHRvbiIsImZpcmVTdW1tYXJ5IiwiYWN0aW9uQnV0dG9uIiwiZmlyZUFjdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJ3aW5kb3ciLCJtYWtlRGl2IiwiY2xhc3NuYW1lIiwicmVtb3ZlQXR0cmlidXRlIiwiVXRpbCIsImJ1dHRvbiIsInRvVXBwZXJDYXNlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImVsZW1lbnQiLCJyZXN0IiwiY2xhc3NMaXN0IiwiYWRkIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUEyQ0Es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LEtBQUt5RixJQUFJRyxNQUFNQyxRQUFVLFFBQ3pCN0YsS0FBSzBFLFFBQVFZLGFBQWEsV0FBWSxLQUN0Q3RGLEtBQUtxRixNQUFNQyxhQUFhLFlBQWEsVUFDckN0RixLQUFLcUYsTUFBTUMsYUFBYSxXQUFZLE1BSS9CLFlBQUFmLEtBQVAsV0FDRXZFLEtBQUt5RixJQUFJRyxNQUFNQyxRQUFVLE9BQ3pCN0YsS0FBSzBFLFFBQVFZLGFBQWEsV0FBWSxNQUN0Q3RGLEtBQUtxRixNQUFNeUQsZ0JBQWdCLGFBQzNCOUksS0FBS3FGLE1BQU1DLGFBQWEsV0FBWSxPQUd4QyxFQTlCQSxHQUFhLEVBQUFxQixROzs7OzJEQy9UYixJQUFVb0MsRSxpREFBVixTQUFVQSxHQUVLLEVBQUFoQixXQUFhLFNBQ3hCcEgsRUFBY3dHLEVBQW1CdkMsRUFDakNpRSxRQUFBLElBQUFBLE1BQUEsSUFDQSxJQUFJRyxFQUFTOUQsU0FBU0MsY0FBYyxVQUtwQyxPQUpBNkQsRUFBT3pELFVBQVk1RSxFQUNuQixFQUFBeUUsU0FBUzRELEVBQVFILEdBQWFsSSxFQUFLc0ksZUFDbkNELEVBQU9FLGlCQUFpQixRQUFTL0IsR0FDakN2QyxFQUFPUCxZQUFZMkUsR0FDWkEsR0FLSSxFQUFBNUQsU0FBVyxTQUFTK0QsRyxJQUFzQix3REFDckRDLEVBQUtwRixTQUFRLFNBQUFGLEdBQUssT0FBQXFGLEVBQVFFLFVBQVVDLElBSHpCLE1BR3NDeEYsRUFBRW1GLG1CQWhCdkQsQ0FBVUYsTUFBSSxLQXFCZCxVQUFlQSIsImZpbGUiOiJkZWNpc2lvbnRyZWUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJkZWNpc2lvbnRyZWVcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wiZGVjaXNpb250cmVlXCJdID0gZmFjdG9yeSgpO1xufSkodGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IFwiLi90cy9pbmRleC50c1wiKTtcbiIsImltcG9ydCB7VHJlZSBhcyBvYmowfSBmcm9tICcuL3RyZWUnO1xuXG5leHBvcnQgbGV0IFRyZWUgPSBvYmowO1xuIiwiLy8gSW5pdGlhbCB0cmVlXG5pbXBvcnQgVXRpbCBmcm9tICcuL3V0aWwnO1xuXG5cbmV4cG9ydCBjbGFzcyBUcmVlIHtcblxuICBwdWJsaWMganNvblN0cjogc3RyaW5nID0gJyc7XG4gIHB1YmxpYyByb290OiBOb2RlID0gbnVsbDtcbiAgcHVibGljIGhpc3Rvcnk6IG51bWJlcltdID0gW107XG4gIHB1YmxpYyByb290RWxlbWVudDogSFRNTEVsZW1lbnQ7XG4gIHB1YmxpYyBzdW1tYXJ5RWxlbWVudDogSFRNTEVsZW1lbnQ7XG5cbiAgcHVibGljIGxvYWRKc29uKHVybDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGxldCBodHRwUmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgaHR0cFJlcXVlc3Qub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChodHRwUmVxdWVzdC5yZWFkeVN0YXRlID09PSA0KSB7XG4gICAgICAgICAgaWYgKGh0dHBSZXF1ZXN0LnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICB0aGlzLl9sb2FkSnNvbihodHRwUmVxdWVzdC5yZXNwb25zZVRleHQsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdChodHRwUmVxdWVzdC5zdGF0dXNUZXh0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0uYmluZCh0aGlzKTtcbiAgICAgIGh0dHBSZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KGh0dHBSZXF1ZXN0LnN0YXR1c1RleHQpO1xuICAgICAgfS5iaW5kKHRoaXMpO1xuICAgICAgaHR0cFJlcXVlc3Qub3BlbignR0VUJywgdXJsLCB0cnVlKTtcbiAgICAgIGh0dHBSZXF1ZXN0LnNlbmQoKTtcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBfbG9hZEpzb24oanNvbjogc3RyaW5nLCByZXNvbHZlOiBGdW5jdGlvbiwgcmVqZWN0OiBGdW5jdGlvbikge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmpzb25TdHIgPSBqc29uO1xuICAgICAgdGhpcy5mcm9tSnNvbigpO1xuICAgICAgcmVzb2x2ZSgnSlNPTiBsb2FkZWQnKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHJlamVjdCgnSlNPTiBQYXJzZXIgRXJyb3IhJyk7XG4gICAgfVxuICB9XG5cblxuICBwdWJsaWMgZnJvbUpzb24oKSB7XG4gICAgdGhpcy5yb290ID0gTm9kZS5mcm9tSnNvbihKU09OLnBhcnNlKHRoaXMuanNvblN0cikpO1xuICAgIGxldCBkZnMgPSBuZXcgRGVwdGhGaXJzdCh0aGlzLCAoeDogTm9kZSkgPT4geCk7XG4gICAgZGZzLnJlc3VsdC5mb3JFYWNoKG4gPT4gbi50cmVlID0gdGhpcyk7XG4gIH1cblxuXG4gIHB1YmxpYyB0b0hUTUwobm9kZTogSFRNTEVsZW1lbnQgPSBudWxsKSB7XG4gICAgdGhpcy5yb290RWxlbWVudCA9IG5vZGU7XG4gICAgbGV0IGRmcyA9IG5ldyBEZXB0aEZpcnN0KHRoaXMsICh4OiBOb2RlKSA9PiB4KTtcbiAgICBkZnMucmVzdWx0LmZvckVhY2goKG46IE5vZGUpID0+IHtcbiAgICAgIG5vZGUuYXBwZW5kQ2hpbGQobi50b0h0bWwoKSk7XG4gICAgICBuLmhpZGUoKTtcbiAgICB9KTtcbiAgICB0aGlzLnJvb3Quc2hvdygpO1xuICB9XG5cbiAgcHVibGljIHN1bW1hcnkobm9kZTogTm9kZSkge1xuICAgIG5vZGUuaGlkZSgpO1xuICAgIGxldCByZXN1bHQ6IFtzdHJpbmcsIHN0cmluZ11bXSA9IFtbbm9kZS5jb250ZW50LCAnJ11dO1xuICAgIGxldCBjb3VudCA9IDA7XG4gICAgbm9kZSA9IG5vZGUucGFyZW50O1xuICAgIHdoaWxlIChub2RlKSB7XG4gICAgICBjb3VudCsrO1xuICAgICAgbGV0IHZhbHVlID0gdGhpcy5oaXN0b3J5W3RoaXMuaGlzdG9yeS5sZW5ndGggLSBjb3VudF07XG4gICAgICByZXN1bHQudW5zaGlmdChbbm9kZS5jb250ZW50LCBub2RlLmxhYmVscy5nZXQodmFsdWUpXSk7XG4gICAgICBub2RlID0gbm9kZS5wYXJlbnQ7XG4gICAgfVxuICAgIHRoaXMucHJpbnRTdW1tYXJ5KHJlc3VsdCk7XG4gIH1cblxuICBwcml2YXRlIHByaW50U3VtbWFyeShzdW1tYXJ5OiBbc3RyaW5nLCBzdHJpbmddW10pIHtcbiAgICB0aGlzLnN1bW1hcnlFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgVXRpbC5hZGRDbGFzcyh0aGlzLnN1bW1hcnlFbGVtZW50LCAnTk9ERScsICdTVU1NQVJZJyk7XG4gICAgdGhpcy5yb290RWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLnN1bW1hcnlFbGVtZW50KTtcbiAgICBsZXQgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgVXRpbC5hZGRDbGFzcyh0aXRsZSwgJ1RJVExFJyk7XG4gICAgdGl0bGUuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xuICAgIHRpdGxlLmlubmVySFRNTCA9ICdTdW1tYXJ5JztcbiAgICB0aGlzLnN1bW1hcnlFbGVtZW50LmFwcGVuZENoaWxkKHRpdGxlKTtcbiAgICBmb3IgKGxldCBbcXVlc3Rpb24sIHJlc3VsdF0gb2Ygc3VtbWFyeSkge1xuICAgICAgbGV0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgbGV0IHNwYW4xID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgc3BhbjEuaW5uZXJIVE1MID0gcXVlc3Rpb247XG4gICAgICBkaXYuYXBwZW5kQ2hpbGQoc3BhbjEpO1xuICAgICAgbGV0IHNwYW4yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgc3BhbjIuaW5uZXJIVE1MID0gcmVzdWx0O1xuICAgICAgZGl2LmFwcGVuZENoaWxkKHNwYW4yKTtcbiAgICAgIHRoaXMuc3VtbWFyeUVsZW1lbnQuYXBwZW5kQ2hpbGQoZGl2KTtcbiAgICB9XG4gICAgdGhpcy5zdW1tYXJ5RWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgfVxuXG59XG5cblxuZXhwb3J0IGNsYXNzIERlcHRoRmlyc3Qge1xuXG4gIHB1YmxpYyByZXN1bHQ6IGFueVtdID0gW107XG5cbiAgY29uc3RydWN0b3IodHJlZTogVHJlZSwgcHJpdmF0ZSBmdW5jOiBGdW5jdGlvbikge1xuICAgIHRoaXMudmlzaXQodHJlZS5yb290KTtcbiAgfVxuXG4gIHByaXZhdGUgdmlzaXQobm9kZTogTm9kZSkge1xuICAgIHRoaXMucmVzdWx0LnB1c2godGhpcy5mdW5jKG5vZGUpKTtcbiAgICBub2RlLmNoaWxkcmVuLmZvckVhY2goeCA9PiB0aGlzLnZpc2l0KHgpKTtcbiAgfVxuXG59XG5cblxubGV0IGNvdW50ZXIgPSAwO1xubGV0IGxhYmVsQ291bnRlciA9IDA7XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBOb2RlIHtcblxuICBwdWJsaWMgdHJlZTogVHJlZTtcbiAgcHVibGljIGxhYmVsczogTWFwPG51bWJlciwgc3RyaW5nPiA9IG5ldyBNYXA8bnVtYmVyLCBzdHJpbmc+KCk7XG4gIHB1YmxpYyBraW5kOiBzdHJpbmcgPSAnJztcbiAgcHVibGljIGNoaWxkcmVuOiBNYXA8bnVtYmVyLCBOb2RlPiA9IG5ldyBNYXA8bnVtYmVyLCBOb2RlPigpO1xuICBwdWJsaWMgcGFyZW50OiBOb2RlID0gbnVsbDtcbiAgcHVibGljIHZhcmlhYmxlOiBzdHJpbmcgPSAnZHRfdmFyaWFibGVfJyArIGNvdW50ZXIrKztcbiAgcHVibGljIGNhcmQ6IENhcmQ7XG4gIHB1YmxpYyByYWRpb0J1dHRvbnM6IEhUTUxFbGVtZW50W10gPSBbXTtcbiAgXG4gIHB1YmxpYyBuZXh0TmFtZTogc3RyaW5nID0gJ05leHQnO1xuICBwdWJsaWMgcHJldmlvdXNOYW1lOiBzdHJpbmcgPSAnQmFjayc7XG5cbiAgY29uc3RydWN0b3IocHVibGljIGNvbnRlbnQ6IHN0cmluZywgcHVibGljIHRpdGxlOiBzdHJpbmcgPSAnJyxcbiAgICAgICAgICAgICAgcHVibGljIHZhbHVlID0gMCxcbiAgICAgICAgICAgICAgbGFiZWxzOiB7dGV4dDogc3RyaW5nLCB2YWx1ZTogbnVtYmVyfVtdID0gW10pIHtcbiAgICB0aGlzLmNhcmQgPSBuZXcgQ2FyZCgpO1xuICAgIGZvciAobGV0IHt0ZXh0OiB0ZXh0LCB2YWx1ZTogdmFsdWV9IG9mIGxhYmVscykge1xuICAgICAgdGhpcy5sYWJlbHMuc2V0KHZhbHVlLCB0ZXh0KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBwYXJzZUNoaWxkcmVuKG5vZGU6IE5vZGUsIGpzb246IGFueVtdKSB7XG4gICAgaWYgKCFqc29uIHx8ICFqc29uLmxlbmd0aCkgcmV0dXJuO1xuICAgIGZvciAoY29uc3QgY2hpbGQgb2YganNvbikge1xuICAgICAgbGV0IGNoaWxkTm9kZSA9IE5vZGUuZnJvbUpzb24oY2hpbGQpO1xuICAgICAgbm9kZS5jaGlsZHJlbi5zZXQoY2hpbGROb2RlLnZhbHVlLCBjaGlsZE5vZGUpO1xuICAgICAgY2hpbGROb2RlLnBhcmVudCA9IG5vZGU7XG4gICAgfVxuICB9XG5cbiAgc3RhdGljIGZyb21Kc29uKGpzb246IGFueSk6IE5vZGUge1xuICAgIGxldCBraW5kID0ganNvbi50eXBlIHx8ICdsZWFmJztcbiAgICBsZXQgbm9kZTogTm9kZSA9IG51bGw7XG4gICAgc3dpdGNoIChraW5kKSB7XG4gICAgICBjYXNlICdsZWFmJzpcbiAgICAgICAgbm9kZSA9IG5ldyBMZWFmKGpzb24uY29udGVudCwganNvbi50aXRsZSwganNvbi52YWx1ZSwganNvbi5hY3Rpb24pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ25hcnknOlxuICAgICAgICBub2RlID0gbmV3IE5hcnkoanNvbi5jb250ZW50LCBqc29uLnRpdGxlLCBqc29uLnZhbHVlLCBqc29uLmxhYmVscyB8fCBbXSk7XG4gICAgICAgIE5vZGUucGFyc2VDaGlsZHJlbihub2RlLCBqc29uLmNoaWxkcmVuKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdiaW5hcnknOlxuICAgICAgICBub2RlID0gbmV3IEJpbmFyeShqc29uLmNvbnRlbnQsIGpzb24udGl0bGUsIGpzb24udmFsdWUpO1xuICAgICAgICBOb2RlLnBhcnNlQ2hpbGRyZW4obm9kZSwganNvbi5jaGlsZHJlbik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgRXJyb3IoJ1Vua25vd24gbm9kZSB0eXBlLicpO1xuICAgIH1cbiAgICByZXR1cm4gbm9kZTtcbiAgfVxuXG4gIHB1YmxpYyB0b0h0bWwoKTogSFRNTEVsZW1lbnQge1xuICAgIFV0aWwuYWRkQ2xhc3ModGhpcy5jYXJkLmRpdiwgdGhpcy5raW5kKTtcbiAgICAvLyBBY3R1YWwgdGl0bGUgZWxlbWVudFxuICAgIHRoaXMuY2FyZC50aXRsZS5pbm5lckhUTUwgPSB0aGlzLnRpdGxlO1xuICAgIC8vIEFjdHVhbCBjb250ZW50IGVsZW1lbnRcbiAgICBsZXQgY29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBVdGlsLmFkZENsYXNzKGNvbnRlbnQsICdDT05URU5UJyk7XG4gICAgY29udGVudC5pbm5lckhUTUwgPSB0aGlzLmNvbnRlbnQ7XG4gICAgdGhpcy5jYXJkLmNvbnRlbnQuYXBwZW5kQ2hpbGQoY29udGVudCk7XG4gICAgdGhpcy5yYWRpb3MoKTtcbiAgICB0aGlzLmJ1dHRvbnMoKTtcbiAgICByZXR1cm4gdGhpcy5jYXJkLmRpdjtcbiAgfVxuXG5cbiAgcHJvdGVjdGVkIHJhZGlvcygpIHtcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiB0aGlzLmxhYmVscykge1xuICAgICAgbGV0IGNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIFV0aWwuYWRkQ2xhc3MoY29udGVudCwgJ1JBRElPQlVUVE9OJyk7XG4gICAgICBsZXQgcmFkaW8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgVXRpbC5hZGRDbGFzcyhyYWRpbywgJ1JBRElPJyk7XG4gICAgICBsZXQgcmFkaW9JZCA9ICdkdF9pZF8nICsgbGFiZWxDb3VudGVyKys7XG4gICAgICBsZXQgbGFiZWxJZCA9ICdkdF9pZF8nICsgbGFiZWxDb3VudGVyKys7XG4gICAgICByYWRpby50eXBlID0gJ3JhZGlvJztcbiAgICAgIHJhZGlvLmlkID0gcmFkaW9JZDtcbiAgICAgIHJhZGlvLm5hbWUgPSB0aGlzLnZhcmlhYmxlO1xuICAgICAgcmFkaW8udmFsdWUgPSBrZXkudG9TdHJpbmcoKTtcbiAgICAgIHJhZGlvLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbGxlZGJ5JywgbGFiZWxJZCk7XG4gICAgICB0aGlzLnJhZGlvQnV0dG9ucy5wdXNoKHJhZGlvKTtcbiAgICAgIGxldCBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XG4gICAgICBVdGlsLmFkZENsYXNzKGxhYmVsLCAnTEFCRUwnKTtcbiAgICAgIGxhYmVsLmlkID0gbGFiZWxJZDtcbiAgICAgIGxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgcmFkaW9JZCk7XG4gICAgICBsYWJlbC5pbm5lckhUTUwgPSB2YWx1ZTtcbiAgICAgIGNvbnRlbnQuYXBwZW5kQ2hpbGQocmFkaW8pO1xuICAgICAgY29udGVudC5hcHBlbmRDaGlsZChsYWJlbCk7XG4gICAgICB0aGlzLmNhcmQuY29udGVudC5hcHBlbmRDaGlsZChjb250ZW50KTtcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgYnV0dG9ucygpIHtcbiAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgIFV0aWwubWFrZUJ1dHRvbihcbiAgICAgICAgdGhpcy5wcmV2aW91c05hbWUsIHRoaXMuZmlyZVByZXZpb3VzLmJpbmQodGhpcyksIHRoaXMuY2FyZC5idXR0b25zLCAnUFJFVklPVVMnKTtcbiAgICB9XG4gICAgVXRpbC5tYWtlQnV0dG9uKHRoaXMubmV4dE5hbWUsIHRoaXMuZmlyZU5leHQuYmluZCh0aGlzKSwgdGhpcy5jYXJkLmJ1dHRvbnMsICdORVhUJyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZmlyZU5leHQoKSB7XG4gICAgZm9yIChsZXQgcmFkaW8gb2YgdGhpcy5yYWRpb0J1dHRvbnMpIHtcbiAgICAgIGlmICgocmFkaW8gYXMgYW55KS5jaGVja2VkKSB7XG4gICAgICAgIGxldCB2YWx1ZSA9IChyYWRpbyBhcyBhbnkpLnZhbHVlO1xuICAgICAgICBsZXQgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgdGhpcy50cmVlLmhpc3RvcnkucHVzaChudW0pO1xuICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5nZXQobnVtKS5zaG93KCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgZmlyZVByZXZpb3VzKCkge1xuICAgIGlmICh0aGlzLnBhcmVudCkge1xuICAgICAgdGhpcy5oaWRlKCk7XG4gICAgICB0aGlzLnBhcmVudC5zaG93KCk7XG4gICAgfVxuICB9XG5cblxuICAvLyBUT0RPOiBUaGlzIGlzIHByb2JhYmx5IG92ZXJraWxsLlxuICBwdWJsaWMgc2hvdygpIHtcbiAgICB0aGlzLmNhcmQuc2hvdygpO1xuICB9XG5cbiAgcHVibGljIGhpZGUoKSB7XG4gICAgdGhpcy5jYXJkLmhpZGUoKTtcbiAgfVxuXG59XG5cbmV4cG9ydCBjbGFzcyBCaW5hcnkgZXh0ZW5kcyBOb2RlIHtcblxuICAvKipcbiAgICogQG92ZXJyaWRlXG4gICAqL1xuICBwdWJsaWMga2luZCA9ICdiaW5hcnknO1xuXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBjb250ZW50OiBzdHJpbmcsIHB1YmxpYyB0aXRsZTogc3RyaW5nLCBwdWJsaWMgdmFsdWUgPSAwKSB7XG4gICAgc3VwZXIoY29udGVudCwgdGl0bGUsIHZhbHVlLFxuICAgICAgICAgIFt7dGV4dDogJ1llcycsIHZhbHVlOiAxfSwge3RleHQ6ICdObycsIHZhbHVlOiAwfV0pO1xuICB9XG5cbn1cblxuXG5leHBvcnQgY2xhc3MgTmFyeSBleHRlbmRzIE5vZGUge1xuICBwdWJsaWMga2luZCA9ICduYXJ5J1xuXG59XG5cblxuZXhwb3J0IGNsYXNzIExlYWYgZXh0ZW5kcyBOb2RlIHtcbiAgcHVibGljIGtpbmQgPSAnbGVhZic7XG4gIHB1YmxpYyBuZXh0TmFtZSA9ICdSZXN0YXJ0JztcbiAgcHVibGljIHN1bW1hcnlCdXR0b246IEhUTUxFbGVtZW50O1xuICBwdWJsaWMgYWN0aW9uQnV0dG9uOiBIVE1MRWxlbWVudDtcblxuICBjb25zdHJ1Y3Rvcihjb250ZW50OiBzdHJpbmcsIHRpdGxlOiBzdHJpbmcsIHZhbHVlOiBudW1iZXIsXG4gICAgICAgICAgICAgIHB1YmxpYyBhY3Rpb246IHN0cmluZyA9ICcnKSB7XG4gICAgc3VwZXIoY29udGVudCwgdGl0bGUsIHZhbHVlKTtcbiAgfVxuXG5cbiAgcHJvdGVjdGVkIGJ1dHRvbnMoKSB7XG4gICAgc3VwZXIuYnV0dG9ucygpO1xuICAgIHRoaXMuc3VtbWFyeUJ1dHRvbiA9IFV0aWwubWFrZUJ1dHRvbihcbiAgICAgICdTdW1tYXJ5JywgdGhpcy5maXJlU3VtbWFyeS5iaW5kKHRoaXMpLCB0aGlzLmNhcmQuYnV0dG9ucyk7XG4gICAgaWYgKHRoaXMuYWN0aW9uKSB7XG4gICAgICB0aGlzLmFjdGlvbkJ1dHRvbiA9IFV0aWwubWFrZUJ1dHRvbihcbiAgICAgICAgJ0dvJywgdGhpcy5maXJlQWN0aW9uLmJpbmQodGhpcyksIHRoaXMuY2FyZC5idXR0b25zLCAnQUNUSU9OJyk7XG4gICAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgZmlyZUFjdGlvbigpIHtcbiAgICBjb25zb2xlLmxvZygnRmlyaW5nIScpO1xuICAgIHdpbmRvdy5vcGVuKHRoaXMuYWN0aW9uLCAnX2JsYW5rJyk7XG4gIH1cbiAgXG4gIHByb3RlY3RlZCBmaXJlU3VtbWFyeSgpIHtcbiAgICB0aGlzLnRyZWUuc3VtbWFyeSh0aGlzKTtcbiAgfVxuICBcbiAgcHJvdGVjdGVkIGZpcmVOZXh0KCkge1xuICAgIHRoaXMuaGlkZSgpO1xuICAgIHRoaXMudHJlZS5yb290LnNob3coKTtcbiAgICB0aGlzLnRyZWUuaGlzdG9yeSA9IFtdO1xuICB9XG5cbn1cblxuXG5sZXQgbWFrZURpdiA9IGZ1bmN0aW9uKC4uLmNsYXNzbmFtZTogc3RyaW5nW10pIHtcbiAgbGV0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBVdGlsLmFkZENsYXNzKGRpdiwgLi4uY2xhc3NuYW1lKTtcbiAgcmV0dXJuIGRpdjtcbn07XG5cbmV4cG9ydCBjbGFzcyBDYXJkIHtcblxuICBwdWJsaWMgZGl2OiBIVE1MRWxlbWVudCA9IG1ha2VEaXYoJ05PREUnKTtcbiAgcHVibGljIHRpdGxlOiBIVE1MRWxlbWVudCA9IG1ha2VEaXYoJ1RJVExFJyk7XG4gIHB1YmxpYyBjb250ZW50OiBIVE1MRWxlbWVudCA9IG1ha2VEaXYoJ0NPTlRFTlQnKVxuICBwdWJsaWMgYnV0dG9uczogSFRNTEVsZW1lbnQgPSBtYWtlRGl2KCdCVVRUT05TJyk7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5kaXYuYXBwZW5kQ2hpbGQodGhpcy50aXRsZSk7XG4gICAgdGhpcy50aXRsZS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG4gICAgdGhpcy5kaXYuYXBwZW5kQ2hpbGQodGhpcy5jb250ZW50KTtcbiAgICB0aGlzLmNvbnRlbnQuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xuICAgIHRoaXMuZGl2LmFwcGVuZENoaWxkKHRoaXMuYnV0dG9ucyk7XG4gIH1cblxuICBwdWJsaWMgc2hvdygpIHtcbiAgICB0aGlzLmRpdi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICB0aGlzLmNvbnRlbnQuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICcwJyk7XG4gICAgdGhpcy50aXRsZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGl2ZScsICdwb2xpdGUnKTtcbiAgICB0aGlzLnRpdGxlLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnMCcpO1xuICAgIC8vIHRoaXMudGl0bGVFbGVtZW50LmZvY3VzKCk7XG4gIH1cblxuICBwdWJsaWMgaGlkZSgpIHtcbiAgICB0aGlzLmRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIHRoaXMuY29udGVudC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG4gICAgdGhpcy50aXRsZS5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtbGl2ZScpO1xuICAgIHRoaXMudGl0bGUuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xuICB9XG4gIFxufVxuIiwibmFtZXNwYWNlIFV0aWwge1xuXG4gIGV4cG9ydCBjb25zdCBtYWtlQnV0dG9uID0gZnVuY3Rpb24oXG4gICAgbmFtZTogc3RyaW5nLCBhY3Rpb246ICgpID0+IGFueSwgcGFyZW50OiBIVE1MRWxlbWVudCxcbiAgICBjbGFzc25hbWU6IHN0cmluZyA9ICcnKTogSFRNTEJ1dHRvbkVsZW1lbnQge1xuICAgIGxldCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBidXR0b24uaW5uZXJIVE1MID0gbmFtZTtcbiAgICBhZGRDbGFzcyhidXR0b24sIGNsYXNzbmFtZSB8fCBuYW1lLnRvVXBwZXJDYXNlKCkpO1xuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFjdGlvbik7XG4gICAgcGFyZW50LmFwcGVuZENoaWxkKGJ1dHRvbik7XG4gICAgcmV0dXJuIGJ1dHRvbjtcbiAgfTtcblxuICBsZXQgcHJlZml4ID0gJ0RUXyc7XG5cbiAgZXhwb3J0IGNvbnN0IGFkZENsYXNzID0gZnVuY3Rpb24oZWxlbWVudDogSFRNTEVsZW1lbnQsIC4uLnJlc3Q6IHN0cmluZ1tdKSB7XG4gICAgcmVzdC5mb3JFYWNoKHggPT4gZWxlbWVudC5jbGFzc0xpc3QuYWRkKHByZWZpeCArIHgudG9VcHBlckNhc2UoKSkpO1xuICB9O1xuXG59XG5cbmV4cG9ydCBkZWZhdWx0IFV0aWw7XG4iXSwic291cmNlUm9vdCI6IiJ9